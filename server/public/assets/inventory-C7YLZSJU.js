import{a2 as B,f as l,N as c,a9 as r}from"./index-DA11XDlS.js";const L={qi_gathering_pill:{id:"qi_gathering_pill",name:"聚气丹",type:"consumable",quality:"common",description:"炼气期常用辅助丹药，服用后可获得少量修为。",icon:"Pill",stackable:!0,maxStack:99,usable:!0,useEffect:{type:"add_experience",value:100,description:"获得100点修为"},useCondition:{maxRealm:2},tradeable:!0,sellPrice:5,obtainMethod:"宗门宝库兑换、炼丹"},spirit_recovery_pill:{id:"spirit_recovery_pill",name:"回灵丹",type:"consumable",quality:"common",description:"恢复灵力的基础丹药，修炼者必备。",icon:"Pill",stackable:!0,maxStack:99,usable:!0,useEffect:{type:"restore_mp",value:50,description:"恢复50%灵力"},tradeable:!0,sellPrice:3,obtainMethod:"宗门宝库兑换、炼丹"},foundation_pill:{id:"foundation_pill",name:"筑基丹",type:"consumable",quality:"uncommon",description:"突破筑基期的珍贵丹药，可大幅提升突破成功率。",icon:"Sparkles",stackable:!0,maxStack:10,usable:!0,useEffect:{type:"breakthrough_boost",value:20,description:"筑基突破成功率+20%"},useCondition:{minRealm:1,maxRealm:1},tradeable:!0,sellPrice:50,obtainMethod:"宗门宝库兑换、炼丹"},core_formation_pill:{id:"core_formation_pill",name:"结丹丹",type:"consumable",quality:"rare",description:"结丹期突破必备丹药，极为珍贵。",icon:"Sparkles",stackable:!0,maxStack:10,usable:!0,useEffect:{type:"breakthrough_boost",value:15,description:"结丹突破成功率+15%"},useCondition:{minRealm:2,maxRealm:2},tradeable:!0,sellPrice:200,obtainMethod:"宗门宝库兑换、炼丹"},detox_pill:{id:"detox_pill",name:"清毒丹",type:"consumable",quality:"common",description:"可清除体内丹毒的解毒丹药。",icon:"Droplet",stackable:!0,maxStack:99,usable:!0,useEffect:{type:"clear_poison",value:50,description:"清除50%丹毒"},tradeable:!0,sellPrice:10,obtainMethod:"宗门宝库兑换、炼丹"},hp_pill:{id:"hp_pill",name:"疗伤丹",type:"consumable",quality:"common",description:"恢复生命的基础丹药。",icon:"Heart",stackable:!0,maxStack:99,usable:!0,useEffect:{type:"restore_hp",value:30,description:"恢复30%生命"},tradeable:!0,sellPrice:5,obtainMethod:"宗门宝库兑换、炼丹"},experience_scroll:{id:"experience_scroll",name:"心得卷轴",type:"consumable",quality:"uncommon",description:"前辈高人留下的修炼心得，阅读后可获得大量修为。",icon:"Scroll",stackable:!0,maxStack:99,usable:!0,useEffect:{type:"add_experience",value:500,description:"获得500点修为"},tradeable:!0,sellPrice:50,obtainMethod:"宗门宝库兑换、秘境探索"},spirit_stone_bag:{id:"spirit_stone_bag",name:"灵石袋",type:"consumable",quality:"common",description:"装有灵石的小袋子，打开后可获得灵石。",icon:"Coins",stackable:!0,maxStack:99,usable:!0,useEffect:{type:"add_spirit_stones",value:100,description:"获得100灵石"},tradeable:!0,sellPrice:80,obtainMethod:"宗门宝库兑换、任务奖励"},spirit_herb_common:{id:"spirit_herb_common",name:"凡品灵草",type:"material",quality:"common",description:"常见的炼丹材料，可用于炼制低阶丹药。",icon:"Leaf",stackable:!0,maxStack:999,usable:!1,tradeable:!0,sellPrice:1,obtainMethod:"采集、宗门药园"},spirit_herb_uncommon:{id:"spirit_herb_uncommon",name:"灵品灵草",type:"material",quality:"uncommon",description:"较为稀有的炼丹材料，可用于炼制中阶丹药。",icon:"Leaf",stackable:!0,maxStack:999,usable:!1,tradeable:!0,sellPrice:5,obtainMethod:"采集、宗门药园"},spirit_herb_rare:{id:"spirit_herb_rare",name:"玄品灵草",type:"material",quality:"rare",description:"珍稀的炼丹材料，可用于炼制高阶丹药。",icon:"Leaf",stackable:!0,maxStack:999,usable:!1,tradeable:!0,sellPrice:20,obtainMethod:"秘境探索、高级药园"},spirit_ore_common:{id:"spirit_ore_common",name:"凡品灵矿",type:"material",quality:"common",description:"常见的炼器材料，可用于炼制低阶法宝。",icon:"Mountain",stackable:!0,maxStack:999,usable:!1,tradeable:!0,sellPrice:2,obtainMethod:"挖矿、任务奖励"},spirit_ore_uncommon:{id:"spirit_ore_uncommon",name:"灵品灵矿",type:"material",quality:"uncommon",description:"较为稀有的炼器材料。",icon:"Mountain",stackable:!0,maxStack:999,usable:!1,tradeable:!0,sellPrice:10,obtainMethod:"挖矿、秘境探索"},recipe_qi_gathering_pill:{id:"recipe_qi_gathering_pill",name:"聚气丹丹方",type:"recipe",quality:"common",description:"记载聚气丹炼制方法的丹方，使用后永久掌握。",icon:"BookOpen",stackable:!1,maxStack:1,usable:!0,useEffect:{type:"learn_recipe",value:1,description:"学习聚气丹配方"},recipeId:"recipe_qi_gathering_pill",tradeable:!0,sellPrice:20,obtainMethod:"宗门宝库、秘境探索"},recipe_spirit_recovery_pill:{id:"recipe_spirit_recovery_pill",name:"回灵丹丹方",type:"recipe",quality:"common",description:"记载回灵丹炼制方法的丹方，使用后永久掌握。",icon:"BookOpen",stackable:!1,maxStack:1,usable:!0,useEffect:{type:"learn_recipe",value:1,description:"学习回灵丹配方"},recipeId:"recipe_spirit_recovery_pill",tradeable:!0,sellPrice:20,obtainMethod:"宗门宝库、秘境探索"},recipe_detox_pill:{id:"recipe_detox_pill",name:"清毒丹丹方",type:"recipe",quality:"common",description:"记载清毒丹炼制方法的丹方，使用后永久掌握。",icon:"BookOpen",stackable:!1,maxStack:1,usable:!0,useEffect:{type:"learn_recipe",value:1,description:"学习清毒丹配方"},recipeId:"recipe_detox_pill",tradeable:!0,sellPrice:30,obtainMethod:"宗门宝库、秘境探索"},recipe_foundation_pill:{id:"recipe_foundation_pill",name:"筑基丹丹方",type:"recipe",quality:"uncommon",description:"记载筑基丹炼制方法的珍贵丹方，使用后永久掌握。",icon:"BookOpen",stackable:!1,maxStack:1,usable:!0,useEffect:{type:"learn_recipe",value:1,description:"学习筑基丹配方"},recipeId:"recipe_foundation_pill",tradeable:!0,sellPrice:100,obtainMethod:"宗门宝库（内门）、秘境探索"},recipe_hp_pill:{id:"recipe_hp_pill",name:"疗伤丹丹方",type:"recipe",quality:"common",description:"记载疗伤丹炼制方法的丹方，使用后永久掌握。",icon:"BookOpen",stackable:!1,maxStack:1,usable:!0,useEffect:{type:"learn_recipe",value:1,description:"学习疗伤丹配方"},recipeId:"recipe_hp_pill",tradeable:!0,sellPrice:20,obtainMethod:"宗门宝库、秘境探索"},inventory_expansion_10:{id:"inventory_expansion_10",name:"乾坤袋（小）",type:"special",quality:"uncommon",description:"蕴含空间之力的储物袋，使用后永久扩展储物袋10格。",icon:"Package",stackable:!1,maxStack:1,usable:!0,useEffect:{type:"expand_inventory",value:10,description:"储物袋容量+10"},tradeable:!0,sellPrice:100,obtainMethod:"宗门宝库、活动奖励"},inventory_expansion_30:{id:"inventory_expansion_30",name:"乾坤袋（中）",type:"special",quality:"rare",description:"蕴含更强空间之力的储物袋，使用后永久扩展储物袋30格。",icon:"Package",stackable:!1,maxStack:1,usable:!0,useEffect:{type:"expand_inventory",value:30,description:"储物袋容量+30"},tradeable:!0,sellPrice:250,obtainMethod:"宗门宝库（核心）、活动奖励"},inventory_expansion_50:{id:"inventory_expansion_50",name:"乾坤袋（大）",type:"special",quality:"epic",description:"传说级的空间法宝，使用后永久扩展储物袋50格。",icon:"Package",stackable:!1,maxStack:1,usable:!0,useEffect:{type:"expand_inventory",value:50,description:"储物袋容量+50"},tradeable:!0,sellPrice:500,obtainMethod:"稀有掉落、高级活动奖励"}};function f(i){return L[i]}const Q={recipe_qi_gathering_pill:{id:"recipe_qi_gathering_pill",name:"聚气丹",type:"alchemy",quality:"common",description:"炼气期常用丹药，可获得少量修为。",outputItemId:"qi_gathering_pill",outputQuantity:3,outputQuantityBonus:2,materials:[{itemId:"spirit_herb_common",quantity:5}],requirements:{minRealm:1},successRate:80,timeCost:60,failureMaterialLoss:50},recipe_spirit_recovery_pill:{id:"recipe_spirit_recovery_pill",name:"回灵丹",type:"alchemy",quality:"common",description:"恢复灵力的基础丹药。",outputItemId:"spirit_recovery_pill",outputQuantity:5,outputQuantityBonus:3,materials:[{itemId:"spirit_herb_common",quantity:3}],requirements:{minRealm:1},successRate:85,timeCost:30,failureMaterialLoss:50},recipe_hp_pill:{id:"recipe_hp_pill",name:"疗伤丹",type:"alchemy",quality:"common",description:"恢复生命的基础丹药。",outputItemId:"hp_pill",outputQuantity:4,outputQuantityBonus:2,materials:[{itemId:"spirit_herb_common",quantity:4}],requirements:{minRealm:1},successRate:85,timeCost:45,failureMaterialLoss:50},recipe_detox_pill:{id:"recipe_detox_pill",name:"清毒丹",type:"alchemy",quality:"common",description:"清除丹毒的解毒丹药。",outputItemId:"detox_pill",outputQuantity:2,outputQuantityBonus:1,materials:[{itemId:"spirit_herb_common",quantity:3},{itemId:"spirit_herb_uncommon",quantity:1}],requirements:{minRealm:1},successRate:70,timeCost:90,failureMaterialLoss:50},recipe_foundation_pill:{id:"recipe_foundation_pill",name:"筑基丹",type:"alchemy",quality:"uncommon",description:"突破筑基期的珍贵丹药。",outputItemId:"foundation_pill",outputQuantity:1,outputQuantityBonus:1,materials:[{itemId:"spirit_herb_uncommon",quantity:10},{itemId:"spirit_herb_common",quantity:20}],requirements:{minRealm:1},successRate:50,timeCost:300,spiritStoneCost:50,failureMaterialLoss:70}};function O(i){return Q[i]}const H=B("inventory",()=>{const i=l([]),n=l({used:0,total:30,percentage:0}),m=l([]),s=l([]),u=l(!1),d=l(!1),h=c(()=>i.value.length===0),v=c(()=>n.value.used>=n.value.total),k=c(()=>n.value.total-n.value.used),q=c(()=>{const e={consumable:[],material:[],seed:[],recipe:[],equipment:[],special:[]};for(const t of i.value){const a=t.template||f(t.itemId);a&&e[a.type].push(t)}return e}),x=c(()=>s.value.filter(e=>e.learned)),I=c(()=>s.value.filter(e=>!e.learned)),o=async e=>{u.value=!0;try{const{data:t}=await r.getInventory(e);if(i.value=(t.items||[]).map(a=>({...a,template:f(a.itemId)})),t.capacity){const a=t.capacity,p=a.total??a.max??30,b=a.used??0;n.value={used:b,total:p,percentage:p>0?Math.round(b/p*100):0}}return t}finally{u.value=!1}},g=async()=>{try{const{data:e}=await r.getCapacity(),t=e.total??e.max??30,a=e.used??0;return n.value={used:a,total:t,percentage:t>0?Math.round(a/t*100):0},n.value}catch{return null}},M=async(e,t=1)=>{const{data:a}=await r.useItem(e,t);return await o(),a},S=async(e,t=1)=>{const{data:a}=await r.discardItem(e,t);return await o(),a},_=async()=>{u.value=!0;try{const{data:e}=await r.getRecipes();return m.value=e.learnedIds||[],s.value=(e.allRecipes||[]).map(t=>({...t,...O(t.id)})),e}finally{u.value=!1}},P=async e=>{const{data:t}=await r.learnRecipe(e);return await Promise.all([_(),o()]),t},R=async(e,t=1)=>{const{data:a}=await r.canCraft(e,t);return a},E=async(e,t=1)=>{d.value=!0;try{const{data:a}=await r.craft(e,t);return await o(),a}finally{d.value=!1}},C=async(e,t,a=1)=>{const{data:p}=await r.giftItem(e,t.characterId,t.name,a);return await o(),p},w=e=>i.value.find(t=>t.itemId===e),y=e=>i.value.filter(t=>t.itemId===e).reduce((t,a)=>t+a.quantity,0);return{items:i,capacity:n,learnedRecipeIds:m,allRecipes:s,loading:u,craftLoading:d,isEmpty:h,isFull:v,freeSlots:k,itemsByType:q,learnedRecipes:x,unlearnedRecipes:I,fetchInventory:o,fetchCapacity:g,useItem:M,discardItem:S,fetchRecipes:_,learnRecipe:P,checkCanCraft:R,craft:E,giftItem:C,findItemByTemplateId:w,getItemCount:y,hasEnoughItem:(e,t)=>y(e)>=t,hasLearnedRecipe:e=>m.value.includes(e),clear:()=>{i.value=[],n.value={used:0,total:30,percentage:0},m.value=[],s.value=[]}}});export{L as I,f as g,H as u};
