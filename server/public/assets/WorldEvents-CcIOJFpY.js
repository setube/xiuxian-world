import{e as C,cc as S,S as E,a0 as M,c as _,d as r,l as p,p as w,w as o,c5 as N,g as t,a as s,j as y,Z as c,F as g,q as h,n as $,B as z,o as i}from"./index-DA11XDlS.js";import{S as A}from"./sparkles-tsZM6BNv.js";import{C as D}from"./cloud-DPpQV0Uw.js";import{S as I}from"./sun-CivYJ-dd.js";import{Z as V}from"./zap-vMqaBpWc.js";import{C as W}from"./clock-Bnzg_83l.js";import{a as Z,_ as F}from"./Tag-D90sLFiK.js";import{N as L}from"./Icon-B4w7yYiv.js";import{_ as R}from"./Spin-C-vu5Ffa.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./createLucideIcon-DiiZaxVK.js";import"./use-locale-EBm6emhn.js";import"./format-length-B-p6aW7q.js";import"./use-compitable-BnEdbODL.js";const q={class:"world-events-page"},H={class:"buffs-grid"},U={class:"buff-info"},G={class:"buff-name"},J={class:"buff-value"},K={class:"buff-time"},O={class:"buff-info"},P={class:"buff-name"},Q={class:"buff-value"},X={class:"buff-time"},Y={key:0,class:"events-timeline"},ee={class:"event-icon"},te={class:"event-content"},se={class:"event-header"},ne={class:"event-time"},oe={class:"event-description"},ae=C({__name:"WorldEvents",setup(ie){const a=S();let v=null;E(async()=>{await a.init(),v=setInterval(()=>{a.refreshBuffs()},6e4)}),M(()=>{v&&clearInterval(v)});const B=u=>{const n=new Date(u),f=new Date().getTime()-n.getTime(),l=Math.floor(f/6e4);if(l<1)return"刚刚";if(l<60)return`${l}分钟前`;const m=Math.floor(l/60);return m<24?`${m}小时前`:n.toLocaleDateString()},k=u=>{const n=Math.floor(u/6e4);if(n<60)return`${n}分钟`;const d=Math.floor(n/60),f=n%60;return`${d}时${f}分`},T={exp_bonus:"修为奖励",spirit_stones:"灵石奖励",cultivation_buff:"修炼加成",rare_item:"珍稀物品",exp_loss:"修为损失",spirit_stones_loss:"灵石损失",cultivation_debuff:"修炼减益",item_loss:"物品丢失"};return(u,n)=>{const d=Z,f=N,l=L,m=z,x=F,b=R;return i(),_("div",q,[r(f,{title:"天道法则",class:"header-card"},{"header-extra":o(()=>[t(a).cultivationBonus!==0?(i(),p(d,{key:0,type:t(a).cultivationBonus>0?"success":"warning"},{default:o(()=>[y(" 修炼效率 "+c(t(a).cultivationBonus>0?"+":"")+c(t(a).cultivationBonus)+"% ",1)]),_:1},8,["type"])):w("",!0)]),default:o(()=>[n[1]||(n[1]=s("p",{class:"description"},"天道无常，祥瑞与厄运交替降临。每隔一个时辰，天道将随机选择一位修士，降下恩泽或劫难。",-1))]),_:1}),t(a).hasActiveBuff?(i(),p(f,{key:0,title:"当前天机",class:"buffs-card"},{default:o(()=>[s("div",H,[(i(!0),_(g,null,h(t(a).activeBlessing,e=>(i(),_("div",{key:e.effectType+e.expiresAt,class:"buff-item blessing"},[r(l,{size:24,color:"#52c41a"},{default:o(()=>[r(t(A))]),_:1}),s("div",U,[s("span",G,c(T[e.effectType]||e.effectType),1),s("span",J,"+"+c(e.value)+"%",1),s("span",K,"剩余 "+c(k(e.remainingTime)),1)])]))),128)),(i(!0),_(g,null,h(t(a).activeCalamity,e=>(i(),_("div",{key:e.effectType+e.expiresAt,class:"buff-item calamity"},[r(l,{size:24,color:"#ff4d4f"},{default:o(()=>[r(t(D))]),_:1}),s("div",O,[s("span",P,c(T[e.effectType]||e.effectType),1),s("span",Q,"-"+c(e.value)+"%",1),s("span",X,"剩余 "+c(k(e.remainingTime)),1)])]))),128))])]),_:1})):w("",!0),r(f,{title:"天道演化",class:"events-card"},{"header-extra":o(()=>[r(m,{text:"",onClick:n[0]||(n[0]=e=>t(a).fetchRecentEvents())},{icon:o(()=>[r(l,null,{default:o(()=>[r(t(W))]),_:1})]),default:o(()=>[n[2]||(n[2]=y(" 刷新 ",-1))]),_:1})]),default:o(()=>[r(b,{show:t(a).loading},{default:o(()=>[t(a).recentEvents.length>0?(i(),_("div",Y,[(i(!0),_(g,null,h(t(a).recentEvents,e=>(i(),_("div",{key:e.id,class:$(["event-item",e.type])},[s("div",ee,[r(l,{size:20,color:e.type==="blessing"?"#faad14":"#cf1322"},{default:o(()=>[e.type==="blessing"?(i(),p(t(I),{key:0})):(i(),p(t(V),{key:1}))]),_:2},1032,["color"])]),s("div",te,[s("div",se,[r(d,{type:e.type==="blessing"?"warning":"error",size:"small"},{default:o(()=>[y(c(e.type==="blessing"?"祥瑞":"厄运"),1)]),_:2},1032,["type"]),s("span",ne,c(B(e.triggeredAt)),1)]),s("p",oe,c(e.description),1)])],2))),128))])):(i(),p(x,{key:1,description:"暂无天道事件"}))]),_:1},8,["show"])]),_:1})])}}}),Te=j(ae,[["__scopeId","data-v-1f4c0387"]]);export{Te as default};
