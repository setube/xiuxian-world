import{a2 as Se,X as Re,f as R,N as h,a3 as L,e as we,$ as xe,S as Te,a0 as Me,c as l,a as e,p as v,d,n as _,g as t,Z as o,F as A,q as N,l as B,b as De,s as T,a1 as ne,w as P,a4 as ve,h as Ae,j as le,B as pe,o as n}from"./index-DA11XDlS.js";import{u as Pe}from"./composables-BMk_yTOy.js";import{S as j}from"./sparkles-tsZM6BNv.js";import{T as ze}from"./trending-up-BXfb3B-f.js";import{S as me}from"./shield-off-B7Fx9jMD.js";import{c as be}from"./createLucideIcon-DiiZaxVK.js";import{T as re}from"./triangle-alert-vQJa5xBQ.js";import{H as Fe}from"./heart-crack-rbfRmzuO.js";import{L as Ee}from"./log-out-DPfR_OdR.js";import{B as Oe}from"./brain-DeRvb8zF.js";import{T as Le}from"./target-CxCFSND-.js";import{F as he}from"./flame-DuW_991e.js";import{L as _e}from"./loader-circle-BnoPFgCr.js";import{A as Be}from"./activity-B-GwPlTu.js";import{H as Ie}from"./heart-LgXo-eep.js";import{Z as Ne}from"./zap-vMqaBpWc.js";import{S as He}from"./sword-BlVHvUf1.js";import{S as $e}from"./shield-BMlq6Nq0.js";import{W as Ge}from"./wind-DSFUGIbd.js";import{S as Ue}from"./shield-check-fOgaozYJ.js";import{C as Ve}from"./check-Dvn_Mgz0.js";import{X as qe}from"./x-DGyACQy4.js";import{G as fe}from"./gift-BEOm1WG9.js";import{C as We}from"./circle-x-B-Ydbwdk.js";import{C as Xe}from"./circle-check-big-B5OYv702.js";import{S as Ze}from"./star-D9p6u3Oh.js";import{u as Je}from"./use-message--i6DiThE.js";import{_ as Ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ge=be("arrow-big-up",[["path",{d:"M9 13a1 1 0 0 0-1-1H5.061a1 1 0 0 1-.75-1.811l6.836-6.835a1.207 1.207 0 0 1 1.707 0l6.835 6.835a1 1 0 0 1-.75 1.811H16a1 1 0 0 0-1 1v6a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1z",key:"lh0v7k"}]]);const ce=be("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),je={heavenly:{baseSuccessRate:.85,criticalSuccessRate:.15,criticalFailureRate:.02,baseExpGain:100},variant:{baseSuccessRate:.8,criticalSuccessRate:.12,criticalFailureRate:.03,baseExpGain:120},true:{baseSuccessRate:.75,criticalSuccessRate:.1,criticalFailureRate:.05,baseExpGain:80},pseudo:{baseSuccessRate:.65,criticalSuccessRate:.05,criticalFailureRate:.08,baseExpGain:50},waste:{baseSuccessRate:.5,criticalSuccessRate:.02,criticalFailureRate:.15,baseExpGain:20}},K=[{level:1,name:"心猿意马",minActivity:0,successRateBonus:-.1,criticalSuccessBonus:-.05,criticalFailureReduce:-.05,color:"#6b6560"},{level:2,name:"心神不定",minActivity:10,successRateBonus:-.05,criticalSuccessBonus:0,criticalFailureReduce:0,color:"#9ca3af"},{level:3,name:"心平气和",minActivity:30,successRateBonus:0,criticalSuccessBonus:0,criticalFailureReduce:0,color:"#7cb88a"},{level:4,name:"心如止水",minActivity:60,successRateBonus:.05,criticalSuccessBonus:.03,criticalFailureReduce:.02,color:"#6b9fc9"},{level:5,name:"心若琉璃",minActivity:100,successRateBonus:.1,criticalSuccessBonus:.05,criticalFailureReduce:.03,color:"#9c7ab8"},{level:6,name:"道心通明",minActivity:200,successRateBonus:.15,criticalSuccessBonus:.08,criticalFailureReduce:.05,color:"#f0e6c8"}],Ke=600*1e3,Qe=900*1e3,et=480*60*1e3,ue=1320*60*1e3,tt={maxStacks:5,decayTime:1440*60*1e3,decayPerHour:1/24,cultivationPenaltyPerStack:.05,craftingPenaltyPerStack:.08},ke=b=>{for(let u=K.length-1;u>=0;u--){const s=K[u];if(s&&b>=s.minActivity)return s}return K[0]},st=(b,u,s=0)=>{const p=je[b.rootType],k=ke(u);let m=p.baseSuccessRate+k.successRateBonus,C=p.criticalSuccessRate+k.criticalSuccessBonus,g=Math.max(0,p.criticalFailureRate-k.criticalFailureReduce);if(s>0){const w=s*.02;m-=w,g+=w*.5}m=Math.min(.95,Math.max(.3,m)),C=Math.min(.3,Math.max(.01,C)),g=Math.min(.25,Math.max(.01,g));const y=1-m;return{successRate:m,criticalSuccessRate:C,criticalFailureRate:g,failureRate:y}},Q=(b,u)=>{if(!b)return{canCultivate:!0,remainingTime:0,remainingTimeDisplay:""};const p=Date.now()-b,k=u-p;if(k<=0)return{canCultivate:!0,remainingTime:0,remainingTimeDisplay:""};const m=Math.floor(k/36e5),C=Math.floor(k%36e5/6e4),g=Math.floor(k%6e4/1e3),y=m>0?`${m}小时${C}分${g}秒`:C>0?`${C}分${g}秒`:`${g}秒`;return{canCultivate:!1,remainingTime:k,remainingTimeDisplay:y}},at=b=>b===1,ye=[{id:"login",name:"每日登录",points:10,description:"每日首次登录",dailyLimit:1},{id:"cultivation",name:"闭关修炼",points:5,description:"完成一次闭关修炼",dailyLimit:10},{id:"explore",name:"探索秘境",points:8,description:"探索一处秘境",dailyLimit:5},{id:"pvp",name:"切磋论道",points:10,description:"与其他修士切磋",dailyLimit:3},{id:"alchemy",name:"炼丹制器",points:5,description:"炼制一枚丹药或法器",dailyLimit:10},{id:"quest",name:"完成任务",points:15,description:"完成一个任务",dailyLimit:5},{id:"deep_cultivation",name:"神游太虚",points:30,description:"完成一次深度闭关",dailyLimit:1}],it=Se("cultivation",()=>{const b=Re(),u=R(null),s=R(6e5),p=R(30),k=R({}),m=R(!1),C=R(null),g=R(!1),y=R(null),w=R(null),M=R(null),H=R(!1),x=R([]),z=R(!1),U=R(null),F=R(!1),f=R(!1),ee=h(()=>ke(p.value)),$=h(()=>x.value.reduce((i,S)=>i+S.stacks,0)),D=h(()=>{const i=b.spiritRoot;return i?st(i,p.value,$.value):null}),V=h(()=>Q(u.value,s.value)),q=h(()=>V.value.canCultivate&&!m.value&&b.spiritRoot&&!y.value?.isActive),W=h(()=>Q(w.value,ue)),X=h(()=>W.value.canCultivate&&!y.value?.isActive&&b.spiritRoot),te=h(()=>{if(!y.value?.isActive)return null;const i=y.value.endTime-Date.now();if(i<=0)return null;const S=Math.floor(i/36e5),oe=Math.floor(i%36e5/6e4);return`${S}时${oe}分`}),E=h(()=>{const i=b.character?.realm?.tier||1;return at(i)}),Z=async()=>{f.value=!0;try{const{data:i}=await L.getStatus();O(i)}catch(i){console.error("加载修炼状态失败:",i)}finally{f.value=!1}},O=i=>{i.lastCultivationTime!==void 0&&(u.value=i.lastCultivationTime),i.currentCooldown!==void 0&&(s.value=i.currentCooldown),i.activityPoints!==void 0&&(p.value=i.activityPoints),i.activityHistory!==void 0&&(k.value=typeof i.activityHistory=="string"?JSON.parse(i.activityHistory):i.activityHistory||{}),i.deepSession!==void 0&&(y.value=i.deepSession),i.lastDeepCultivationTime!==void 0&&(w.value=i.lastDeepCultivationTime),i.poisonStacks!==void 0&&(Array.isArray(i.poisonStacks)?x.value=i.poisonStacks:typeof i.poisonStacks=="string"?x.value=JSON.parse(i.poisonStacks):x.value=[]),i.peaceMode!==void 0&&(z.value=i.peaceMode)},J=async()=>{if(!q.value)return null;m.value=!0;try{const{data:i}=await L.start();return O(i),C.value=i.result,g.value=!0,i.result?.breakthrough&&await b.fetchStats(),i.result}catch(i){return console.error("闭关修炼失败:",i),null}finally{m.value=!1}},se=async()=>{if(!X.value)return!1;try{const{data:i}=await L.startDeep();return O(i),!0}catch(i){return console.error("开始深度闭关失败:",i),!1}},G=async(i=!1)=>{try{const{data:S}=await L.finishDeep(i);return O(S),M.value=S.result,H.value=!0,S.result?.breakthrough&&await b.fetchStats(),S.result}catch(S){return console.error("结束深度闭关失败:",S),null}},ae=()=>G(!0),ie=async()=>{if(!E.value)return!1;try{const{data:i}=await L.togglePeaceMode();return z.value=i.peaceMode,!0}catch(i){return console.error("切换和平模式失败:",i),!1}},r=async()=>{try{return await L.clearPoison(),x.value=[],!0}catch(i){return console.error("清除丹毒失败:",i),!1}},a=async()=>{try{const{data:i}=await L.handleOnline();O(i),i.passiveExp&&i.passiveExp>0&&(U.value={exp:i.passiveExp,duration:i.offlineDuration||0},F.value=!0)}catch(i){console.error("处理上线失败:",i)}};return{lastCultivationTime:u,currentCooldown:s,activityPoints:p,activityHistory:k,isCultivating:m,lastResult:C,showResultModal:g,deepSession:y,lastDeepCultivationTime:w,deepResult:M,showDeepResultModal:H,poisonStacks:x,peaceMode:z,passiveResult:U,showPassiveResultModal:F,loading:f,daoHeart:ee,totalPoisonStacks:$,cultivationRates:D,cooldownStatus:V,canCultivate:q,deepCooldownStatus:W,canStartDeepCultivation:X,deepSessionRemainingTime:te,canTogglePeaceMode:E,CULTIVATION_COOLDOWN_MIN:Ke,CULTIVATION_COOLDOWN_MAX:Qe,DEEP_CULTIVATION_DURATION:et,DEEP_CULTIVATION_COOLDOWN:ue,ACTIVITY_SOURCES:ye,POISON_CONFIG:tt,loadFromServer:Z,startCultivation:J,startDeepCultivation:se,finishDeepCultivation:G,forceExitDeepCultivation:ae,getActivityRemaining:i=>{const S=ye.find(Ce=>Ce.id===i);if(!S)return 0;const oe=k.value[i]||0;return Math.max(0,S.dailyLimit-oe)},clearAllPoison:r,togglePeaceMode:ie,handleOnline:a,closeResultModal:()=>{g.value=!1},closeDeepResultModal:()=>{H.value=!1},closePassiveResultModal:()=>{F.value=!1},init:async()=>{await Z(),await a(),y.value?.isActive&&y.value.endTime<=Date.now()&&await G()}}}),ot={class:"cultivation-page"},nt={class:"top-bar"},lt={class:"realm-text"},rt={class:"top-right"},ct={class:"combat-power"},ut={key:0,class:"peace-tag"},dt={class:"spirit-bg"},vt={class:"particles-container"},pt={class:"outer-rings"},mt={class:"orb-core"},ht={class:"inner-particles"},_t={class:"progress-ring",viewBox:"0 0 120 120"},ft={class:"cultivation-status"},gt={class:"status-sub"},yt={key:1,class:"status-main"},Rt={class:"status-main"},bt={key:0,class:"status-sub"},kt={key:1,class:"status-sub"},Ct={key:0,class:"poison-banner"},St={key:1,class:"shattered-banner"},wt={class:"shattered-time"},xt={key:2,class:"deep-control-bar"},Tt={key:3,class:"info-cards"},Mt={class:"info-card dao-card"},Dt={class:"card-header"},At={class:"mini-progress"},Pt={class:"card-sub"},zt={key:0,class:"info-card rates-card"},Ft={class:"card-header"},Et={class:"rates-row"},Ot={class:"rate-item"},Lt={class:"rate-val success"},Bt={class:"rate-item"},It={class:"rate-val critical"},Nt={class:"rate-item"},Ht={class:"rate-val failure"},$t={class:"rate-item"},Gt={class:"rate-val danger"},Ut={key:4,class:"tribulation-panel"},Vt={class:"tribulation-header"},qt={class:"tribulation-title"},Wt={key:0,class:"danger-badge"},Xt={class:"tribulation-desc"},Zt={key:0,class:"tribulation-items"},Jt={class:"items-list"},Yt={class:"item-name"},jt={class:"item-count"},Kt={key:1,class:"success-rate"},Qt={class:"rate-value"},es={key:2,class:"tribulation-reason"},ts=["disabled"],ss={key:3,class:"danger-warning"},as={class:"stats-panel"},is={class:"stats-header"},os={class:"stats-grid"},ns={class:"stat-item"},ls={class:"stat-val"},rs={class:"stat-item"},cs={class:"stat-val"},us={class:"stat-item"},ds={class:"stat-val"},vs={class:"stat-item"},ps={class:"stat-val"},ms={class:"stat-item"},hs={class:"stat-val"},_s={class:"stat-item"},fs={class:"stat-val"},gs={key:5,class:"action-area"},ys=["disabled"],Rs={key:0},bs={key:1},ks={key:1,class:"main-action-btn cultivating"},Cs={class:"secondary-actions"},Ss=["disabled"],ws={key:0},xs={key:1},Ts={key:0,class:"result-header"},Ms={key:0,class:"result-content"},Ds={class:"result-message"},As={key:0,class:"adventure-box"},Ps={class:"adventure-header"},zs={class:"adventure-title"},Fs={class:"adventure-desc"},Es={key:0,class:"adventure-bonus"},Os={key:1,class:"breakthrough-box"},Ls={class:"breakthrough-header"},Bs={key:0},Is={key:1},Ns={class:"breakthrough-realm"},Hs={class:"breakthrough-msg"},$s={class:"result-details"},Gs={class:"detail-item"},Us={class:"detail-item"},Vs={class:"result-header"},qs={key:0,class:"deep-result-content"},Ws={class:"deep-summary"},Xs={class:"summary-row"},Zs={class:"summary-row success"},Js={class:"summary-row failure"},Ys={key:0,class:"summary-row special"},js={key:1,class:"summary-row danger"},Ks={key:0,class:"early-exit-warning"},Qs={class:"deep-exp-result"},ea={key:1,class:"breakthrough-box"},ta={class:"breakthrough-header"},sa={key:0},aa={key:1},ia={class:"breakthrough-realm"},oa={class:"breakthrough-msg"},na={key:2,class:"deep-adventures"},la={class:"adventures-title"},ra={class:"adventure-list"},ca={class:"adv-name"},ua=we({__name:"CultivationPanel",setup(b){const u=Re(),s=it(),p=xe(),k=Ae(),m=Je(),C=Pe(),g=R(Date.now());let y=null;const w=h(()=>(g.value,Q(s.lastCultivationTime,s.currentCooldown))),M=h(()=>(g.value,Q(s.lastDeepCultivationTime,ue))),H=h(()=>{if(g.value,!s.deepSession?.isActive)return null;const r=s.deepSession.endTime-Date.now();if(r<=0)return null;const a=Math.floor(r/36e5),c=Math.floor(r%36e5/6e4);return`${a}时${c}分`}),x=h(()=>w.value.canCultivate&&!s.isCultivating&&u.spiritRoot&&!s.deepSession?.isActive),z=h(()=>M.value.canCultivate&&!s.deepSession?.isActive&&u.spiritRoot),U=h(()=>{if(!u.soulStatus?.shattered?.expiresAt)return"";const r=u.soulStatus.shattered.expiresAt-Date.now();if(r<=0)return"";const a=Math.floor(r/(1e3*60*60)),c=Math.floor(r%(1e3*60*60)/(1e3*60));return`${a}时${c}分`}),F=h(()=>{const r=u.character?.realm?.tier,a=u.character?.realm?.subTier,c=u.character?.realmProgress||0;return r===1&&a===4&&c>=100?"foundation":r===2&&a===4&&c>=100?"core_formation":r===3&&a===4&&c>=100?"nascent_soul":null}),f=h(()=>{const r=F.value;return r?r==="foundation"?{name:"筑基之劫",description:"炼气圆满，需渡筑基之劫方可突破至筑基期",dangerous:!1,status:p.foundation}:r==="core_formation"?{name:"结丹之劫",description:"筑基圆满，需渡结丹之劫方可突破至结丹期。失败将形神俱灭！",dangerous:!0,status:p.coreFormation}:r==="nascent_soul"?{name:"元婴之劫",description:"结丹圆满，需渡元婴之劫方可突破至元婴期。失败将形神俱灭！",dangerous:!0,status:p.nascentSoul}:null:null}),ee=()=>{const r=F.value;if(!r)return;const a=f.value;a&&(a.dangerous?C.warning({title:"危险警告",content:`渡${a.name}失败会导致形神俱灭！确定要尝试渡劫吗？此操作不可逆！`,positiveText:"确定渡劫",negativeText:"取消",onPositiveClick:async()=>{await $(r)}}):$(r))},$=async r=>{let a;r==="foundation"?a=await p.attemptFoundation():r==="core_formation"?a=await p.attemptCoreFormation():r==="nascent_soul"&&(a=await p.attemptNascentSoul()),a&&(a.characterDied?(m.error(a.message),setTimeout(()=>{k.push("/create-character")},2e3)):a.success?(m.success(a.message),await u.fetchStats()):m.warning(a.message))};Te(async()=>{try{await u.fetchStats(),s.init(),p.fetchStatus(),u.fetchSoulStatus()}catch(r){console.error("初始化失败:",r)}y=setInterval(()=>{g.value=Date.now()},1e3)}),Me(()=>{y&&(clearInterval(y),y=null)});const D=h(()=>u.character?.realmProgress||0),V=h(()=>u.character?.realm?.tier||1),q=["☰","☱","☲","☳","☴","☵","☶","☷"],W=r=>{const a=r/12*360,c=r*.3,I=3+Math.random()*2,Y=60+Math.random()*30;return{"--angle":`${a}deg`,"--delay":`${c}s`,"--duration":`${I}s`,"--distance":`${Y}px`}},X=h(()=>{const r=2*Math.PI*54,a=D.value/100;return r*(1-a)}),te=h(()=>{const r=s.activityPoints,a=s.daoHeart,c=K.find(de=>de.level===a.level+1);if(!c)return 100;const I=c.minActivity-a.minActivity,Y=r-a.minActivity;return Math.min(100,Math.max(0,Y/I*100))}),E=r=>(r*100).toFixed(1)+"%",Z=r=>{switch(r){case"critical_success":return Ze;case"success":return Xe;case"failure":return re;case"critical_failure":return We}},O=r=>r.split(`

`)[0]||r,J=r=>({common:"普通",rare:"稀有",epic:"史诗",legendary:"传说"})[r]||r,se=async()=>{if(!x.value){w.value.canCultivate||m.warning(`修炼冷却中，请${w.value.remainingTimeDisplay}后再试`);return}await s.startCultivation()},G=()=>{if(!z.value){M.value.canCultivate||m.warning(`神游太虚冷却中，请${M.value.remainingTimeDisplay}后再试`);return}C.warning({title:"神游太虚",content:"即将进入8小时深度闭关，期间将自动进行多次修炼。每日仅可进行一次，确定开始？",positiveText:"开始",negativeText:"取消",onPositiveClick:()=>{s.startDeepCultivation(),m.success("已进入神游太虚状态")}})},ae=()=>{C.warning({title:"强行出关",content:"提前出关将只能获得50%的收益，确定要强行出关吗？",positiveText:"确定出关",negativeText:"继续修炼",onPositiveClick:()=>{s.forceExitDeepCultivation()}})},ie=async()=>{await s.togglePeaceMode()&&m.success(s.peaceMode?"已开启避世模式":"已关闭避世模式")};return(r,a)=>(n(),l("div",ot,[e("div",nt,[e("div",{class:_(["realm-badge",`realm-tier-${V.value}`])},[d(t(j),{size:16,class:"realm-icon"}),e("span",lt,o(t(u).realmDisplay),1)],2),e("div",rt,[e("div",ct,[d(t(ze),{size:14}),e("span",null,o(t(u).combatPower),1)]),t(s).peaceMode?(n(),l("div",ut,[d(t(me),{size:12})])):v("",!0)])]),e("div",{class:_(["main-cultivation-area",{cultivating:t(s).isCultivating||t(s).deepSession?.isActive}])},[e("div",dt,[(n(),l(A,null,N(6,c=>e("div",{class:"spirit-line",key:c,style:T({"--delay":c*.5+"s"})},null,4)),64))]),e("div",vt,[(n(),l(A,null,N(12,c=>e("div",{class:"particle",key:c,style:T(W(c))},null,4)),64))]),e("div",pt,[e("div",{class:_(["ring ring-1",{active:t(s).isCultivating}])},null,2),e("div",{class:_(["ring ring-2",{active:t(s).isCultivating}])},null,2),e("div",{class:_(["ring ring-3",{active:D.value>=100}])},null,2)]),e("div",{class:_(["cultivation-orb",{breakthrough:D.value>=100}])},[a[3]||(a[3]=e("div",{class:"orb-glow"},null,-1)),e("div",mt,[e("div",{class:_(["orb-inner",{pulsing:t(s).isCultivating,deep:t(s).deepSession?.isActive}])},[e("div",ht,[(n(),l(A,null,N(6,c=>e("span",{key:c,class:"inner-particle",style:T({"--i":c})},null,4)),64))]),t(s).deepSession?.isActive?(n(),B(t(ce),{key:0,size:32,class:"orb-icon deep"})):(n(),B(t(j),{key:1,size:32,class:"orb-icon"}))],2)]),(n(),l("svg",_t,[a[2]||(a[2]=De('<defs data-v-881903e6><linearGradient id="ringGradient" x1="0%" y1="0%" x2="100%" y2="100%" data-v-881903e6><stop offset="0%" style="stop-color:#7a9e8e;" data-v-881903e6></stop><stop offset="50%" style="stop-color:#c9a959;" data-v-881903e6></stop><stop offset="100%" style="stop-color:#7a9e8e;" data-v-881903e6></stop></linearGradient></defs><circle class="ring-bg" cx="60" cy="60" r="54" data-v-881903e6></circle>',2)),e("circle",{class:_(["ring-progress",{full:D.value>=100}]),cx:"60",cy:"60",r:"54",style:T({strokeDashoffset:X.value})},null,6)])),e("div",{class:_(["bagua-symbols",{rotating:t(s).isCultivating}])},[(n(),l(A,null,N(8,c=>e("span",{class:"symbol",key:c,style:T({"--angle":(c-1)*45+"deg"})},o(q[c-1]),5)),64))],2)],2),e("div",ft,[t(s).deepSession?.isActive?(n(),l(A,{key:0},[a[4]||(a[4]=e("span",{class:"status-main deep"},"神游太虚中",-1)),e("span",gt,o(H.value),1)],64)):t(s).isCultivating?(n(),l("span",yt,"修炼中...")):(n(),l(A,{key:2},[e("span",Rt,o(D.value)+"%",1),D.value>=100?(n(),l("span",bt,"修为圆满")):(n(),l("span",kt,"距突破"))],64))])],2),t(s).totalPoisonStacks>0?(n(),l("div",Ct,[d(t(re),{size:14}),e("span",null,"丹毒 "+o(t(s).totalPoisonStacks)+" 层（-"+o(t(s).totalPoisonStacks*5)+"%收益）",1)])):v("",!0),t(u).isSoulShattered?(n(),l("div",St,[d(t(Fe),{size:14}),a[5]||(a[5]=e("span",null,"道心破碎（闭关收益-50%）",-1)),e("span",wt,o(U.value),1)])):v("",!0),t(s).deepSession?.isActive?(n(),l("div",xt,[e("button",{class:"exit-btn",onClick:ae},[d(t(Ee),{size:16}),a[6]||(a[6]=e("span",null,"强行出关",-1))]),a[7]||(a[7]=e("span",{class:"exit-warning"},"提前出关收益减半",-1))])):v("",!0),t(s).deepSession?.isActive?v("",!0):(n(),l("div",Tt,[e("div",Mt,[e("div",Dt,[d(t(Oe),{size:14}),a[8]||(a[8]=e("span",null,"道心",-1))]),e("div",{class:"dao-level",style:T({color:t(s).daoHeart.color})},o(t(s).daoHeart.name),5),e("div",At,[e("div",{class:"mini-fill",style:T({width:te.value+"%"})},null,4)]),e("span",Pt,"活跃度 "+o(t(s).activityPoints),1)]),t(s).cultivationRates?(n(),l("div",zt,[e("div",Ft,[d(t(Le),{size:14}),a[9]||(a[9]=e("span",null,"概率",-1))]),e("div",Et,[e("div",Ot,[e("span",Lt,o(E(t(s).cultivationRates.successRate)),1),a[10]||(a[10]=e("span",{class:"rate-lbl"},"成功",-1))]),e("div",Bt,[e("span",It,o(E(t(s).cultivationRates.criticalSuccessRate*t(s).cultivationRates.successRate)),1),a[11]||(a[11]=e("span",{class:"rate-lbl"},"大悟",-1))]),e("div",Nt,[e("span",Ht,o(E(t(s).cultivationRates.failureRate)),1),a[12]||(a[12]=e("span",{class:"rate-lbl"},"失败",-1))]),e("div",$t,[e("span",Gt,o(E(t(s).cultivationRates.criticalFailureRate)),1),a[13]||(a[13]=e("span",{class:"rate-lbl"},"入魔",-1))])])])):v("",!0)])),F.value&&f.value?(n(),l("div",Ut,[e("div",Vt,[d(t(he),{size:20,class:"tribulation-icon"}),e("span",qt,o(f.value.name),1),f.value.dangerous?(n(),l("span",Wt,"危")):v("",!0)]),e("p",Xt,o(f.value.description),1),f.value.status?.requiredItems?.length?(n(),l("div",Zt,[a[14]||(a[14]=e("div",{class:"items-title"},"所需物品",-1)),e("div",Jt,[(n(!0),l(A,null,N(f.value.status.requiredItems,c=>(n(),l("div",{key:c.itemId,class:_(["item-row",{sufficient:c.owned>=c.required}])},[e("span",Yt,o(c.name),1),e("span",jt,[e("span",{class:_({insufficient:c.owned<c.required})},o(c.owned),3),le(" / "+o(c.required),1)]),(n(),B(ne(c.owned>=c.required?t(Ve):t(qe)),{size:14,class:"item-status"}))],2))),128))])])):v("",!0),f.value.status?.successRate?(n(),l("div",Kt,[a[15]||(a[15]=e("span",{class:"rate-label"},"成功率",-1)),e("span",Qt,o((f.value.status.successRate*100).toFixed(1))+"%",1)])):v("",!0),f.value.status?.reason?(n(),l("div",es,[d(t(re),{size:14}),e("span",null,o(f.value.status.reason),1)])):v("",!0),e("button",{class:_(["tribulation-btn",{disabled:!f.value.status?.canAttempt,dangerous:f.value.dangerous,attempting:t(p).attempting}]),disabled:!f.value.status?.canAttempt||t(p).attempting,onClick:ee},[t(p).attempting?(n(),B(t(_e),{key:0,size:18,class:"spinning"})):(n(),B(t(he),{key:1,size:18})),e("span",null,o(t(p).attempting?"渡劫中...":"尝试渡劫"),1)],10,ts),f.value.dangerous?(n(),l("p",ss,"警告：渡劫失败将导致形神俱灭，角色永久死亡！")):v("",!0)])):v("",!0),e("div",as,[e("div",is,[d(t(Be),{size:14}),a[16]||(a[16]=e("span",null,"属性",-1))]),e("div",os,[e("div",ns,[d(t(Ie),{size:16,class:"stat-icon hp"}),e("span",ls,o(t(u).stats?.maxHp||0),1),a[17]||(a[17]=e("span",{class:"stat-lbl"},"生命",-1))]),e("div",rs,[d(t(Ne),{size:16,class:"stat-icon mp"}),e("span",cs,o(t(u).stats?.maxMp||0),1),a[18]||(a[18]=e("span",{class:"stat-lbl"},"灵力",-1))]),e("div",us,[d(t(He),{size:16,class:"stat-icon attack"}),e("span",ds,o(t(u).stats?.attack||0),1),a[19]||(a[19]=e("span",{class:"stat-lbl"},"攻击",-1))]),e("div",vs,[d(t($e),{size:16,class:"stat-icon defense"}),e("span",ps,o(t(u).stats?.defense||0),1),a[20]||(a[20]=e("span",{class:"stat-lbl"},"防御",-1))]),e("div",ms,[d(t(Ge),{size:16,class:"stat-icon speed"}),e("span",hs,o(t(u).stats?.speed||0),1),a[21]||(a[21]=e("span",{class:"stat-lbl"},"速度",-1))]),e("div",_s,[d(t(j),{size:16,class:"stat-icon luck"}),e("span",fs,o(t(u).stats?.luck||0),1),a[22]||(a[22]=e("span",{class:"stat-lbl"},"幸运",-1))])])]),t(s).deepSession?.isActive?v("",!0):(n(),l("div",gs,[t(s).isCultivating?(n(),l("button",ks,[d(t(_e),{size:22,class:"spinning"}),a[23]||(a[23]=e("span",null,"修炼中",-1))])):(n(),l("button",{key:0,class:_(["main-action-btn",{disabled:!x.value}]),disabled:!x.value,onClick:se},[d(t(j),{size:22}),w.value.canCultivate?(n(),l("span",Rs,"闭关修炼")):(n(),l("span",bs,o(w.value.remainingTimeDisplay),1))],10,ys)),e("div",Cs,[e("button",{class:_(["secondary-btn deep",{disabled:!z.value}]),disabled:!z.value,onClick:G},[d(t(ce),{size:16}),M.value.canCultivate?(n(),l("span",ws,"神游太虚")):(n(),l("span",xs,o(M.value.remainingTimeDisplay),1))],10,Ss),t(s).canTogglePeaceMode?(n(),l("button",{key:0,class:_(["secondary-btn peace",{active:t(s).peaceMode}]),onClick:ie},[(n(),B(ne(t(s).peaceMode?t(me):t(Ue)),{size:16})),e("span",null,o(t(s).peaceMode?"入世":"避世"),1)],2)):v("",!0)])])),d(t(ve),{show:t(s).showResultModal,"onUpdate:show":a[0]||(a[0]=c=>t(s).showResultModal=c),"mask-closable":!0,preset:"card",style:{width:"360px"}},{header:P(()=>[t(s).lastResult?(n(),l("div",Ts,[(n(),B(ne(Z(t(s).lastResult.outcome.type)),{size:24})),e("span",{style:T({color:t(s).lastResult.outcome.color})},o(t(s).lastResult.outcome.label),5)])):v("",!0)]),footer:P(()=>[d(t(pe),{type:"primary",block:"",onClick:t(s).closeResultModal},{default:P(()=>[...a[27]||(a[27]=[le("确定",-1)])]),_:1},8,["onClick"])]),default:P(()=>[t(s).lastResult?(n(),l("div",Ms,[e("p",Ds,o(O(t(s).lastResult.message)),1),t(s).lastResult.adventure?(n(),l("div",As,[e("div",Ps,[d(t(fe),{size:16}),e("span",zs,o(t(s).lastResult.adventure.name),1),e("span",{class:_(["adventure-rarity",t(s).lastResult.adventure.rarity])},o(J(t(s).lastResult.adventure.rarity)),3)]),e("p",Fs,o(t(s).lastResult.adventure.description),1),t(s).lastResult.adventure.expBonus>0?(n(),l("div",Es," 额外修为 +"+o(t(s).lastResult.adventure.expBonus),1)):v("",!0)])):v("",!0),e("div",{class:_(["result-exp",t(s).lastResult.outcome.type])},[a[24]||(a[24]=e("span",{class:"exp-label"},"修为变化",-1)),e("span",{class:_(["exp-value",{negative:t(s).lastResult.finalExp<0}])},o(t(s).lastResult.finalExp>=0?"+":"")+o(t(s).lastResult.finalExp),3)],2),t(s).lastResult.breakthrough?(n(),l("div",Os,[e("div",Ls,[d(t(ge),{size:20}),t(s).lastResult.breakthrough.breakthroughCount&&t(s).lastResult.breakthrough.breakthroughCount>1?(n(),l("span",Bs," 连续突破 "+o(t(s).lastResult.breakthrough.breakthroughCount)+" 次！ ",1)):(n(),l("span",Is,"境界突破！"))]),e("p",Ns,o(t(s).lastResult.breakthrough.newRealmName),1),e("p",Hs,o(t(s).lastResult.breakthrough.message),1)])):v("",!0),e("div",$s,[e("div",Gs,[a[25]||(a[25]=e("span",null,"道心境界",-1)),e("span",{style:T({color:t(s).lastResult.daoHeart.color})},o(t(s).lastResult.daoHeart.name),5)]),e("div",Us,[a[26]||(a[26]=e("span",null,"下次冷却",-1)),e("span",null,o(Math.floor(t(s).lastResult.cooldown/6e4))+"分钟",1)])])])):v("",!0)]),_:1},8,["show"]),d(t(ve),{show:t(s).showDeepResultModal,"onUpdate:show":a[1]||(a[1]=c=>t(s).showDeepResultModal=c),"mask-closable":!0,preset:"card",style:{width:"380px"}},{header:P(()=>[e("div",Vs,[d(t(ce),{size:24}),a[28]||(a[28]=e("span",{class:"deep-result-title"},"神游太虚结算",-1))])]),footer:P(()=>[d(t(pe),{type:"primary",block:"",onClick:t(s).closeDeepResultModal},{default:P(()=>[...a[35]||(a[35]=[le("确定",-1)])]),_:1},8,["onClick"])]),default:P(()=>[t(s).deepResult?(n(),l("div",qs,[e("div",Ws,[e("div",Xs,[a[29]||(a[29]=e("span",null,"闭关次数",-1)),e("span",null,o(t(s).deepResult.totalSessions)+"次",1)]),e("div",Zs,[a[30]||(a[30]=e("span",null,"成功",-1)),e("span",null,o(t(s).deepResult.successCount+t(s).deepResult.criticalSuccessCount)+"次",1)]),e("div",Js,[a[31]||(a[31]=e("span",null,"失败",-1)),e("span",null,o(t(s).deepResult.failureCount+t(s).deepResult.criticalFailureCount)+"次",1)]),t(s).deepResult.criticalSuccessCount>0?(n(),l("div",Ys,[a[32]||(a[32]=e("span",null,"大彻大悟",-1)),e("span",null,o(t(s).deepResult.criticalSuccessCount)+"次",1)])):v("",!0),t(s).deepResult.criticalFailureCount>0?(n(),l("div",js,[a[33]||(a[33]=e("span",null,"走火入魔",-1)),e("span",null,o(t(s).deepResult.criticalFailureCount)+"次",1)])):v("",!0)]),t(s).deepResult.wasEarlyExit?(n(),l("div",Ks,"提前出关，收益减半")):v("",!0),e("div",Qs,[a[34]||(a[34]=e("span",{class:"exp-label"},"总修为变化",-1)),e("span",{class:_(["exp-value",{negative:t(s).deepResult.totalExp<0}])},o(t(s).deepResult.totalExp>=0?"+":"")+o(t(s).deepResult.totalExp),3)]),t(s).deepResult.breakthrough?(n(),l("div",ea,[e("div",ta,[d(t(ge),{size:20}),t(s).deepResult.breakthrough.breakthroughCount&&t(s).deepResult.breakthrough.breakthroughCount>1?(n(),l("span",sa," 连续突破 "+o(t(s).deepResult.breakthrough.breakthroughCount)+" 次！ ",1)):(n(),l("span",aa,"境界突破！"))]),e("p",ia,o(t(s).deepResult.breakthrough.newRealmName),1),e("p",oa,o(t(s).deepResult.breakthrough.message),1)])):v("",!0),t(s).deepResult.adventures.length>0?(n(),l("div",na,[e("div",la,[d(t(fe),{size:16}),e("span",null,"奇遇汇总（"+o(t(s).deepResult.adventures.length)+"次）",1)]),e("div",ra,[(n(!0),l(A,null,N(t(s).deepResult.adventures,(c,I)=>(n(),l("div",{key:I,class:"adventure-item"},[e("span",ca,o(c.name),1),e("span",{class:_(["adv-rarity",c.rarity])},o(J(c.rarity)),3)]))),128))])])):v("",!0)])):v("",!0)]),_:1},8,["show"])]))}}),Ha=Ye(ua,[["__scopeId","data-v-881903e6"]]);export{Ha as default};
