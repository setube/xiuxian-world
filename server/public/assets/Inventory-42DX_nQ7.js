import{u as K}from"./inventory-C7YLZSJU.js";import{P as x}from"./package-CRVIogFf.js";import{N as W,a as X}from"./Tabs-CdCqfdBl.js";import{c as G}from"./createLucideIcon-DiiZaxVK.js";import{F as I}from"./flame-DuW_991e.js";import{S as z}from"./scroll-CZOg3h_v.js";import{S as B}from"./sword-BlVHvUf1.js";import{L as Y}from"./lock-CWZIQcVF.js";import{S as ee}from"./sparkles-tsZM6BNv.js";import{_ as te}from"./InputNumber-tuzvZVlG.js";import{Z as ae}from"./zap-vMqaBpWc.js";import{B as se}from"./book-open-B-z3oi1Q.js";import{G as N}from"./gift-BEOm1WG9.js";import{T as le}from"./trash-2-CYTYb_kz.js";import{e as ne,f as _,N as oe,x as ie,S as ue,c as i,a,d as u,g as n,Z as r,s as h,n as S,w as f,F as L,q as M,a4 as T,l as D,p as v,a1 as F,B as U,j as V,o}from"./index-DA11XDlS.js";import{S as re}from"./sprout-Dj0E8u8v.js";import{u as de}from"./use-message--i6DiThE.js";import{_ as ce}from"./Input-DOOhwlQ-.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Add-C6IKdIGC.js";import"./use-compitable-BnEdbODL.js";import"./use-merged-state-DvdMjKiF.js";import"./use-locale-EBm6emhn.js";const E=G("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);const ve=G("package-open",[["path",{d:"M12 22v-9",key:"x3hkom"}],["path",{d:"M15.17 2.21a1.67 1.67 0 0 1 1.63 0L21 4.57a1.93 1.93 0 0 1 0 3.36L8.82 14.79a1.655 1.655 0 0 1-1.64 0L3 12.43a1.93 1.93 0 0 1 0-3.36z",key:"2ntwy6"}],["path",{d:"M20 13v3.87a2.06 2.06 0 0 1-1.11 1.83l-6 3.08a1.93 1.93 0 0 1-1.78 0l-6-3.08A2.06 2.06 0 0 1 4 16.87V13",key:"1pmm1c"}],["path",{d:"M21 12.43a1.93 1.93 0 0 0 0-3.36L8.83 2.2a1.64 1.64 0 0 0-1.63 0L3 4.57a1.93 1.93 0 0 0 0 3.36l12.18 6.86a1.636 1.636 0 0 0 1.63 0z",key:"12ttoo"}]]),me={class:"inventory-page"},ye={class:"capacity-bar"},fe={class:"capacity-info"},_e={class:"capacity-text"},be={class:"capacity-progress"},ge={class:"tab-label"},ke={key:0,class:"tab-count"},he={key:0,class:"items-grid"},we=["onClick"],xe={key:0,class:"item-quantity"},qe={class:"item-info"},Ce={class:"item-type"},$e={key:0,class:"item-bound"},Ie={key:1,class:"empty-state"},ze={key:0,class:"detail-content"},Be={class:"detail-row"},Ne={class:"detail-row"},Se={class:"detail-value"},Le={class:"detail-row"},Me={class:"detail-value"},Te={key:0,class:"detail-row"},De={key:1,class:"detail-desc"},Fe={key:2,class:"detail-effect"},Ue={key:3,class:"action-quantity"},Ve={class:"quantity-control"},Ee={class:"action-buttons"},Ge=["disabled"],Ze=["disabled"],Ae=["disabled"],Pe={class:"gift-header"},Qe={class:"gift-content"},Oe={class:"gift-item-info"},Re={class:"gift-quantity"},je={class:"gift-target"},He={class:"gift-actions"},Je=ne({__name:"Inventory",setup(Ke){const d=K(),m=de(),g=_("all"),s=_(null),y=_(!1),c=_(1),p=_(!1),k=_(!1),b=_(""),Z=[{value:"all",label:"全部",icon:x},{value:"consumable",label:"丹药",icon:I},{value:"material",label:"材料",icon:x},{value:"recipe",label:"配方",icon:z},{value:"equipment",label:"装备",icon:B},{value:"special",label:"特殊",icon:E}],q=oe(()=>g.value==="all"?d.items:d.itemsByType[g.value]||[]),C=l=>l==="all"?d.items.length:d.itemsByType[l]?.length||0,w=l=>({common:"#9d9d9d",uncommon:"#1eff00",rare:"#0070dd",epic:"#a335ee",legendary:"#ff8000"})[l||"common"],A=l=>({common:"普通",uncommon:"优秀",rare:"稀有",epic:"史诗",legendary:"传说"})[l||"common"],$=l=>({consumable:"消耗品",material:"材料",seed:"种子",recipe:"配方",equipment:"装备",special:"特殊"})[l||"consumable"],P=l=>({consumable:I,material:x,seed:re,recipe:z,equipment:B,special:E})[l||"consumable"],Q=l=>({add_experience:t=>`获得 ${t} 修为`,add_hp:t=>`恢复 ${t} 生命`,add_mp:t=>`恢复 ${t} 灵力`,add_hp_percent:t=>`恢复 ${t}% 生命`,add_mp_percent:t=>`恢复 ${t}% 灵力`,clear_poison:t=>`清除 ${t}% 丹毒`,breakthrough_bonus:t=>`突破成功率 +${t}%`,expand_inventory:t=>`储物袋容量 +${t}`})[l.type]?.(l.value)||l.type,O=l=>{s.value=l,c.value=1,y.value=!0},R=async()=>{if(s.value){p.value=!0;try{const l=await d.useItem(s.value.id,c.value);m.success(l.message||"使用成功"),y.value=!1,s.value=null}catch(l){m.error(l.message||"使用失败")}finally{p.value=!1}}},j=async()=>{if(s.value){p.value=!0;try{const l=await d.learnRecipe(s.value.id);m.success(`成功学会 ${l.recipeName}`),y.value=!1,s.value=null}catch(l){m.error(l.message||"学习失败")}finally{p.value=!1}}},H=async()=>{if(s.value){p.value=!0;try{await d.discardItem(s.value.id,c.value),m.success(`丢弃了 ${c.value} 个物品`),y.value=!1,s.value=null}catch(l){m.error(l.message||"丢弃失败")}finally{p.value=!1}}},J=async()=>{if(!(!s.value||!b.value)){p.value=!0;try{const l=await d.giftItem(s.value.id,{name:b.value},c.value);m.success(`成功赠送给 ${l.targetName}`),k.value=!1,y.value=!1,s.value=null,b.value=""}catch(l){m.error(l.message||"赠送失败")}finally{p.value=!1}}};return ie(y,l=>{l||(c.value=1)}),ue(()=>{d.fetchInventory()}),(l,e)=>(o(),i("div",me,[a("div",ye,[a("div",fe,[u(n(x),{size:18}),e[10]||(e[10]=a("span",null,"储物袋",-1)),a("span",_e,r(n(d).capacity.used)+" / "+r(n(d).capacity.total),1)]),a("div",be,[a("div",{class:S(["capacity-fill",{warning:n(d).capacity.percentage>80,full:n(d).isFull}]),style:h({width:n(d).capacity.percentage+"%"})},null,6)])]),u(n(W),{value:g.value,"onUpdate:value":e[0]||(e[0]=t=>g.value=t),type:"segment",animated:"",class:"filter-tabs"},{default:f(()=>[(o(),i(L,null,M(Z,t=>u(n(X),{key:t.value,name:t.value},{default:f(()=>[a("div",ge,[(o(),D(F(t.icon),{size:14})),a("span",null,r(t.label),1),C(t.value)>0?(o(),i("span",ke,r(C(t.value)),1)):v("",!0)])]),_:2},1032,["name"])),64))]),_:1},8,["value"]),q.value.length>0?(o(),i("div",he,[(o(!0),i(L,null,M(q.value,t=>(o(),i("div",{key:t.id,class:S(["item-card",{selected:s.value?.id===t.id}]),onClick:We=>O(t)},[a("div",{class:"item-icon",style:h({borderColor:w(t.template?.quality)})},[(o(),D(F(P(t.template?.type)),{size:20})),t.quantity>1?(o(),i("span",xe,r(t.quantity),1)):v("",!0)],4),a("div",qe,[a("div",{class:"item-name",style:h({color:w(t.template?.quality)})},r(t.template?.name||t.itemId),5),a("div",Ce,r($(t.template?.type)),1)]),t.isBound?(o(),i("div",$e,[u(n(Y),{size:12})])):v("",!0)],10,we))),128))])):(o(),i("div",Ie,[u(n(ve),{size:48}),a("span",null,r(g.value==="all"?"储物袋空空如也":"没有该类型的物品"),1)])),u(n(T),{show:y.value,"onUpdate:show":e[6]||(e[6]=t=>y.value=t),preset:"card",style:{width:"90%","max-width":"400px"}},{header:f(()=>[a("div",{class:"detail-header",style:h({color:w(s.value?.template?.quality)})},r(s.value?.template?.name),5)]),default:f(()=>[s.value?(o(),i("div",ze,[a("div",Be,[e[11]||(e[11]=a("span",{class:"detail-label"},"品质",-1)),a("span",{class:"detail-value",style:h({color:w(s.value.template?.quality)})},r(A(s.value.template?.quality)),5)]),a("div",Ne,[e[12]||(e[12]=a("span",{class:"detail-label"},"类型",-1)),a("span",Se,r($(s.value.template?.type)),1)]),a("div",Le,[e[13]||(e[13]=a("span",{class:"detail-label"},"数量",-1)),a("span",Me,r(s.value.quantity),1)]),s.value.isBound?(o(),i("div",Te,[...e[14]||(e[14]=[a("span",{class:"detail-label"},"绑定",-1),a("span",{class:"detail-value bound"},"已绑定",-1)])])):v("",!0),s.value.template?.description?(o(),i("div",De,r(s.value.template.description),1)):v("",!0),s.value.template?.useEffect?(o(),i("div",Fe,[u(n(ee),{size:14}),a("span",null,r(Q(s.value.template.useEffect)),1)])):v("",!0),s.value.quantity>1?(o(),i("div",Ue,[e[15]||(e[15]=a("span",null,"操作数量",-1)),a("div",Ve,[a("button",{onClick:e[1]||(e[1]=t=>c.value=Math.max(1,c.value-1))},"-"),u(n(te),{value:c.value,"onUpdate:value":e[2]||(e[2]=t=>c.value=t),min:1,max:s.value.quantity,size:"small"},null,8,["value","max"]),a("button",{onClick:e[3]||(e[3]=t=>c.value=Math.min(s.value.quantity,c.value+1))},"+"),a("button",{class:"max-btn",onClick:e[4]||(e[4]=t=>c.value=s.value.quantity)},"最大")])])):v("",!0),a("div",Ee,[s.value.template?.usable?(o(),i("button",{key:0,class:"action-btn use-btn",disabled:p.value,onClick:R},[u(n(ae),{size:14}),e[16]||(e[16]=a("span",null,"使用",-1))],8,Ge)):v("",!0),s.value.template?.type==="recipe"?(o(),i("button",{key:1,class:"action-btn learn-btn",disabled:p.value,onClick:j},[u(n(se),{size:14}),e[17]||(e[17]=a("span",null,"学习",-1))],8,Ze)):v("",!0),s.value.template?.tradeable&&!s.value.isBound?(o(),i("button",{key:2,class:"action-btn gift-btn",onClick:e[5]||(e[5]=t=>k.value=!0)},[u(n(N),{size:14}),e[18]||(e[18]=a("span",null,"赠送",-1))])):v("",!0),a("button",{class:"action-btn discard-btn",disabled:p.value,onClick:H},[u(n(le),{size:14}),e[19]||(e[19]=a("span",null,"丢弃",-1))],8,Ae)])])):v("",!0)]),_:1},8,["show"]),u(n(T),{show:k.value,"onUpdate:show":e[9]||(e[9]=t=>k.value=t),preset:"card",style:{width:"90%","max-width":"360px"}},{header:f(()=>[a("div",Pe,[u(n(N),{size:18}),e[20]||(e[20]=a("span",null,"赠送物品",-1))])]),default:f(()=>[a("div",Qe,[a("div",Oe,[a("span",null,r(s.value?.template?.name),1),a("span",Re,"x"+r(c.value),1)]),a("div",je,[u(n(ce),{value:b.value,"onUpdate:value":e[7]||(e[7]=t=>b.value=t),placeholder:"输入道友名称"},null,8,["value"])]),a("div",He,[u(n(U),{onClick:e[8]||(e[8]=t=>k.value=!1)},{default:f(()=>[...e[21]||(e[21]=[V("取消",-1)])]),_:1}),u(n(U),{type:"primary",loading:p.value,disabled:!b.value,onClick:J},{default:f(()=>[...e[22]||(e[22]=[V("确认赠送",-1)])]),_:1},8,["loading","disabled"])])])]),_:1},8,["show"])]))}}),ht=pe(Je,[["__scopeId","data-v-20fc3122"]]);export{ht as default};
