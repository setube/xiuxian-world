import{a2 as ge,f as x,N as b,bu as M,e as oe,c as d,n as U,p as w,d as n,a as e,g as s,F as E,l as j,Z as c,j as v,s as A,bv as me,o as i,ac as be,S as we,x as xe,w as g,r as Ee,q as S,a4 as D,B as V}from"./index-DA11XDlS.js";import{L as $e}from"./lock-CWZIQcVF.js";import{S as R}from"./sprout-Dj0E8u8v.js";import{L as Ce}from"./leaf-CVdWMOfX.js";import{c as H}from"./createLucideIcon-DiiZaxVK.js";import{C as ze}from"./circle-x-B-Ydbwdk.js";import{P as ke}from"./plus-BY3P3rBe.js";import{C as ae}from"./clock-Bnzg_83l.js";import{T as Me}from"./trash-2-CYTYb_kz.js";import{T as ne}from"./triangle-alert-vQJa5xBQ.js";import{C as W}from"./compass-Ib-7RBlT.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as Pe}from"./swords-bfqjVPqN.js";import{U as Te}from"./user-CXIJJnqr.js";import{Z as He}from"./zap-vMqaBpWc.js";import{S as Se}from"./sword-BlVHvUf1.js";import{L as Ne}from"./log-out-DPfR_OdR.js";import{C as Le}from"./circle-alert-CQn7xOz3.js";import{L as _e}from"./loader-Bk8qWIrR.js";import{C as te}from"./crown-CTywvOnR.js";import{S as Ae}from"./sparkles-tsZM6BNv.js";import{P as pe}from"./package-CRVIogFf.js";import{C as qe}from"./coins-Ks2rpWqM.js";import{u as Ge}from"./use-message--i6DiThE.js";import{N as Be,b as se}from"./Tabs-CdCqfdBl.js";import"./Add-C6IKdIGC.js";import"./use-compitable-BnEdbODL.js";import"./use-merged-state-DvdMjKiF.js";const Ve=H("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const Ue=H("bug",[["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M14 7a4 4 0 0 1 4 4v3a6 6 0 0 1-12 0v-3a4 4 0 0 1 4-4z",key:"uouzyp"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M21 21a4 4 0 0 0-3.81-4",key:"1b0z45"}],["path",{d:"M21 5a4 4 0 0 1-3.55 3.97",key:"5cxbf6"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M3 21a4 4 0 0 1 3.81-4",key:"1fjd4g"}],["path",{d:"M3 5a4 4 0 0 0 3.55 3.97",key:"1d7oge"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M9 7.13V6a3 3 0 1 1 6 0v1.13",key:"1vgav8"}]]);const ve=H("flower-2",[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]]);const je=H("flower",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M12 16.5A4.5 4.5 0 1 1 7.5 12 4.5 4.5 0 1 1 12 7.5a4.5 4.5 0 1 1 4.5 4.5 4.5 4.5 0 1 1-4.5 4.5",key:"14wa3c"}],["path",{d:"M12 7.5V9",key:"1oy5b0"}],["path",{d:"M7.5 12H9",key:"eltsq1"}],["path",{d:"M16.5 12H15",key:"vk5kw4"}],["path",{d:"M12 16.5V15",key:"k7eayi"}],["path",{d:"m8 8 1.88 1.88",key:"nxy4qf"}],["path",{d:"M14.12 9.88 16 8",key:"1lst6k"}],["path",{d:"m8 16 1.88-1.88",key:"h2eex1"}],["path",{d:"M14.12 14.12 16 16",key:"uqkrx3"}]]);const Fe=H("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);const Ze=H("hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);const ye=H("leafy-green",[["path",{d:"M2 22c1.25-.987 2.27-1.975 3.9-2.2a5.56 5.56 0 0 1 3.8 1.5 4 4 0 0 0 6.187-2.353 3.5 3.5 0 0 0 3.69-5.116A3.5 3.5 0 0 0 20.95 8 3.5 3.5 0 1 0 16 3.05a3.5 3.5 0 0 0-5.831 1.373 3.5 3.5 0 0 0-5.116 3.69 4 4 0 0 0-2.348 6.155C3.499 15.42 4.409 16.712 4.2 18.1 3.926 19.743 3.014 20.732 2 22",key:"1134nt"}],["path",{d:"M2 22 17 7",key:"1q7jp2"}]]);const Ie=H("tree-deciduous",[["path",{d:"M8 19a4 4 0 0 1-2.24-7.32A3.5 3.5 0 0 1 9 6.03V6a3 3 0 1 1 6 0v.04a3.5 3.5 0 0 1 3.24 5.65A4 4 0 0 1 16 19Z",key:"oadzkq"}],["path",{d:"M12 19v3",key:"npa21l"}]]),De=ge("herbGarden",()=>{const l=x(null),o=x([]),f=x(null),y=x(!1),h=x(!1),p=b(()=>l.value?.plots||[]),u=b(()=>p.value.filter(r=>r.plotType==="normal")),$=b(()=>p.value.filter(r=>r.plotType==="elder")),z=b(()=>p.value.filter(r=>!r.isLocked)),N=b(()=>z.value.filter(r=>r.status==="empty")),L=b(()=>z.value.filter(r=>r.status==="mature")),C=b(()=>z.value.filter(r=>r.eventType!=="none")),q=b(()=>l.value?.isAlchemyElder||!1),G=b(()=>l.value?.canExpand||!1),O=b(()=>l.value?.expansionCost||0),X=b(()=>f.value?.inCombat||!1),F=b(()=>f.value?.remainingToday||0),T=async()=>{y.value=!0;try{const{data:r}=await M.getGarden();return l.value=r,r}finally{y.value=!1}},Z=async()=>{try{const{data:r}=await M.getSeeds();return o.value=r.seeds||[],r.seeds}catch{return[]}},B=async()=>{try{const{data:r}=await M.getExploreStatus();return f.value=r,r}catch{return null}};return{garden:l,seeds:o,exploreStatus:f,loading:y,actionLoading:h,plots:p,normalPlots:u,elderPlots:$,unlockedPlots:z,emptyPlots:N,maturePlots:L,plotsWithEvents:C,isAlchemyElder:q,canExpand:G,expansionCost:O,inCombat:X,remainingExploreToday:F,fetchGarden:T,fetchSeeds:Z,fetchExploreStatus:B,plant:async(r,k)=>{h.value=!0;try{const{data:_}=await M.plant(r,k);return await Promise.all([T(),Z()]),_}finally{h.value=!1}},harvest:async r=>{h.value=!0;try{const{data:k}=await M.harvest(r);return await T(),k}finally{h.value=!1}},handleEvent:async(r,k)=>{h.value=!0;try{const{data:_}=await M.handleEvent(r,k);return await T(),_}finally{h.value=!1}},expandGarden:async()=>{h.value=!0;try{const{data:r}=await M.expand();return await T(),r}finally{h.value=!1}},becomeElder:async()=>{h.value=!0;try{const{data:r}=await M.becomeElder();return await T(),r}finally{h.value=!1}},startExplore:async r=>{h.value=!0;try{const{data:k}=await M.startExplore(r);return k.combat?.inCombat?f.value={inCombat:!0,combat:{monster:{name:k.combat.monster.name,currentHp:k.combat.monsterHp,maxHp:k.combat.monster.hp},playerHp:k.combat.playerHp,round:k.combat.round},remainingToday:(f.value?.remainingToday||3)-1}:await B(),k}finally{h.value=!1}},combat:async r=>{h.value=!0;try{const{data:k}=await M.combat(r);return k.combatEnded?f.value={inCombat:!1,remainingToday:f.value?.remainingToday||0}:f.value?.combat&&(f.value.combat={...f.value.combat,monster:{...f.value.combat.monster,currentHp:k.monsterHp},playerHp:k.playerHp,round:k.round}),k}finally{h.value=!1}},getPlot:r=>p.value.find(k=>k.plotIndex===r),clear:()=>{l.value=null,o.value=[],f.value=null}}}),Re={none:null,weed:{type:"weed",name:"杂草丛生",description:"灵田中长满杂草，严重影响灵草生长。",effect:"生长速度降低50%",actionName:"除草",action:"weed"},pest:{type:"pest",name:"虫害侵扰",description:"害虫正在啃食灵草，收成将大幅减少。",effect:"产量降低30%",actionName:"除虫",action:"pesticide"},drought:{type:"drought",name:"灵气干涸",description:"灵田缺水，灵草有枯萎的风险。",effect:"20%概率枯萎",actionName:"浇水",action:"water"}},We={maxNormalPlots:8};function fe(l){return{common:"#9d9d9d",uncommon:"#1eff00",rare:"#0070dd",epic:"#a335ee",legendary:"#ff8000"}[l]}const Oe={key:0,class:"locked-overlay"},Xe={class:"plot-icon"},Qe={class:"plot-info"},Je={class:"plot-index"},Ke={class:"seed-name"},Ye={class:"growth-progress"},et={class:"progress-bar"},tt={class:"progress-text"},st={class:"remaining-time"},at={class:"seed-name mature-name"},nt={class:"seed-name withered-name"},ot=oe({__name:"PlotCard",props:{plot:{},index:{},isLocked:{type:Boolean},isElderPlot:{type:Boolean}},emits:["plant","harvest","handle-event","explore"],setup(l,{emit:o}){const f=l,y=o,h=()=>{if(!f.plot||f.plot.eventType==="none")return;const p=Re[f.plot.eventType];p&&y("handle-event",f.index,p.action)};return(p,u)=>(i(),d("div",{class:U(["plot-card",{locked:l.isLocked,empty:l.plot?.status==="empty",growing:l.plot?.status==="growing",mature:l.plot?.status==="mature",withered:l.plot?.status==="withered","has-event":l.plot?.eventType!=="none","elder-plot":l.isElderPlot}])},[l.isLocked?(i(),d("div",Oe,[n(s($e),{size:20}),u[4]||(u[4]=e("span",null,"未解锁",-1))])):l.plot?(i(),d(E,{key:1},[e("div",Xe,[l.plot.status==="empty"?(i(),j(s(R),{key:0,size:24})):l.plot.status==="growing"?(i(),j(s(Ce),{key:1,size:24,class:"growing-icon"})):l.plot.status==="mature"?(i(),j(s(je),{key:2,size:24,class:"mature-icon"})):l.plot.status==="withered"?(i(),j(s(ze),{key:3,size:24,class:"withered-icon"})):w("",!0)]),e("div",Qe,[e("span",Je,c(l.index+1)+"号",1),l.plot.status==="empty"?(i(),d(E,{key:0},[u[6]||(u[6]=e("span",{class:"plot-status empty"},"空闲",-1)),e("button",{class:"plot-action-btn plant-btn",onClick:u[0]||(u[0]=$=>p.$emit("plant",l.index))},[n(s(ke),{size:12}),u[5]||(u[5]=v(" 播种 ",-1))])],64)):l.plot.status==="growing"?(i(),d(E,{key:1},[e("span",Ke,c(l.plot.seedName),1),e("div",Ye,[e("div",et,[e("div",{class:"progress-fill",style:A({width:l.plot.growthProgress+"%"})},null,4)]),e("span",tt,c(l.plot.growthProgress)+"%",1)]),e("span",st,[n(s(ae),{size:10}),v(" "+c(l.plot.remainingTime),1)])],64)):l.plot.status==="mature"?(i(),d(E,{key:2},[e("span",at,c(l.plot.seedName),1),u[8]||(u[8]=e("span",{class:"plot-status mature"},"可采收",-1)),e("button",{class:"plot-action-btn harvest-btn",onClick:u[1]||(u[1]=$=>p.$emit("harvest",l.index))},[n(s(Ze),{size:12}),u[7]||(u[7]=v(" 采收 ",-1))])],64)):l.plot.status==="withered"?(i(),d(E,{key:3},[e("span",nt,c(l.plot.seedName),1),u[10]||(u[10]=e("span",{class:"plot-status withered"},"已枯萎",-1)),e("button",{class:"plot-action-btn clear-btn",onClick:u[2]||(u[2]=$=>p.$emit("harvest",l.index))},[n(s(Me),{size:12}),u[9]||(u[9]=v(" 清理 ",-1))])],64)):w("",!0)]),l.plot.eventType!=="none"?(i(),d("div",{key:0,class:"event-badge",onClick:me(h,["stop"])},[n(s(ne),{size:14}),e("span",null,c(l.plot.eventName),1)])):w("",!0)],64)):w("",!0),l.isElderPlot&&!l.isLocked&&l.plot?.status==="empty"?(i(),d("button",{key:2,class:"explore-badge",onClick:u[3]||(u[3]=me($=>p.$emit("explore",l.index),["stop"]))},[n(s(W),{size:12}),u[11]||(u[11]=v(" 探索 ",-1))])):w("",!0)],2))}}),he=le(ot,[["__scopeId","data-v-a651e136"]]),lt={class:"combat-view"},it={class:"combat-header"},rt={class:"round-badge"},dt={class:"combatants"},ct={class:"combatant player"},ut={class:"combatant-icon"},mt={class:"combatant-info"},pt={class:"hp-bar"},vt={class:"hp-text"},yt={class:"vs-icon"},ft={class:"combatant monster"},ht={class:"combatant-icon monster-icon"},kt={class:"combatant-info"},gt={class:"combatant-name monster-name"},bt={class:"hp-bar"},wt={class:"hp-text"},xt={class:"combat-actions"},Et=["disabled"],$t=["disabled"],Ct={class:"combat-hint"},zt=oe({__name:"CombatView",props:{combat:{},loading:{type:Boolean}},emits:["attack","flee"],setup(l){const o=l,f=b(()=>o.combat?Math.max(0,o.combat.playerHp/1e3*100):100),y=b(()=>o.combat?.monster?Math.max(0,o.combat.monster.currentHp/o.combat.monster.maxHp*100):100);return(h,p)=>(i(),d("div",lt,[e("div",it,[n(s(Pe),{size:20}),p[2]||(p[2]=e("span",null,"战斗中",-1)),e("span",rt,"第 "+c(l.combat?.round||1)+" 回合",1)]),e("div",dt,[e("div",ct,[e("div",ut,[n(s(Te),{size:28})]),e("div",mt,[p[3]||(p[3]=e("span",{class:"combatant-name"},"你",-1)),e("div",pt,[e("div",{class:"hp-fill player-hp",style:A({width:f.value+"%"})},null,4)]),e("span",vt,"HP: "+c(l.combat?.playerHp||0),1)])]),e("div",yt,[n(s(He),{size:24})]),e("div",ft,[e("div",ht,[n(s(Ue),{size:28})]),e("div",kt,[e("span",gt,c(l.combat?.monster?.name||"妖兽"),1),e("div",bt,[e("div",{class:"hp-fill monster-hp",style:A({width:y.value+"%"})},null,4)]),e("span",wt,"HP: "+c(l.combat?.monster?.currentHp||0)+"/"+c(l.combat?.monster?.maxHp||0),1)])])]),e("div",xt,[e("button",{class:"action-btn attack-btn",disabled:l.loading,onClick:p[0]||(p[0]=u=>h.$emit("attack"))},[n(s(Se),{size:18}),p[4]||(p[4]=e("span",null,"攻击",-1))],8,Et),e("button",{class:"action-btn flee-btn",disabled:l.loading,onClick:p[1]||(p[1]=u=>h.$emit("flee"))},[n(s(Ne),{size:18}),p[5]||(p[5]=e("span",null,"逃跑",-1))],8,$t)]),e("div",Ct,[n(s(Le),{size:14}),p[6]||(p[6]=e("span",null,"逃跑有50%成功率，失败会受到伤害",-1))])]))}}),Mt=le(zt,[["__scopeId","data-v-1d469317"]]),Pt={class:"herb-garden-page"},Tt={key:0,class:"loading-state"},Ht={key:1,class:"no-access"},St={class:"no-access-icon"},Nt={class:"garden-particles"},Lt={class:"garden-header"},_t={class:"header-left"},At={class:"garden-icon-wrapper"},qt={class:"header-info"},Gt={class:"header-meta"},Bt={class:"plot-count"},Vt={key:0,class:"elder-badge"},Ut={class:"header-actions"},jt={class:"tab-label"},Ft={class:"tab-content"},Zt={key:0,class:"events-alert"},It={class:"plot-section"},Dt={class:"section-title"},Rt={class:"section-count"},Wt={class:"plots-grid"},Ot={class:"section-title"},Xt={key:0,class:"locked-hint"},Qt={class:"plots-grid"},Jt={class:"tab-label"},Kt={class:"tab-content"},Yt={class:"seeds-grid"},es={class:"seed-header"},ts={class:"seed-count"},ss={class:"seed-desc"},as={class:"seed-info"},ns={class:"info-item"},os={class:"info-item"},ls={key:0,class:"info-item elder-only"},is={key:0,class:"no-seeds"},rs={class:"tab-label"},ds={class:"tab-content"},cs={class:"explore-header"},us={class:"explore-info"},ms={class:"explore-limit"},ps={key:0,class:"combat-panel"},vs={key:1,class:"explore-plots"},ys={class:"explore-plot-list"},fs=["onClick"],hs={class:"explore-plot-icon"},ks={class:"explore-plot-info"},gs={class:"explore-plot-name"},bs={class:"modal-header"},ws={class:"plant-modal-content"},xs={class:"plant-hint"},Es={class:"seed-select-list"},$s=["onClick"],Cs={class:"seed-select-left"},zs={class:"seed-select-time"},Ms={class:"seed-select-count"},Ps={key:0,class:"no-available-seeds"},Ts={class:"expand-modal-content"},Hs={class:"expand-hint"},Ss={class:"modal-header"},Ns={class:"explore-result-content"},Ls={key:0,class:"explore-result"},_s={class:"result-message"},As={key:0,class:"encounter-monster"},qs={key:1,class:"direct-rewards"},Gs={class:"reward-list"},Bs={key:0,class:"reward-item"},Vs=oe({__name:"HerbGarden",setup(l){const o=De(),f=be(),y=Ge(),h=x(!0),p=x("plots"),u=x(!1),$=x(!1),z=x(!1),N=x(!1),L=x(0),C=x(null),q=b(()=>f.mySect?.sectId==="huangfeng"),G=b(()=>We.maxNormalPlots),O=b(()=>o.isAlchemyElder?11:G.value),X=b(()=>{const m=o.garden?.unlockedNormalPlots||0,t=o.isAlchemyElder?3:0;return m+t}),F=b(()=>o.garden?.unlockedNormalPlots||0),T=b(()=>o.isAlchemyElder?!1:o.garden?.canBecomeElder?.can||!1),Z=b(()=>o.isAlchemyElder&&f.mySect?.rank==="elder"),B=m=>o.getPlot(m)||null,ie=m=>o.getPlot(m)?.isLocked??!0,Q=b(()=>{const m=o.getPlot(L.value);return m?o.seeds.filter(t=>t.owned<=0?!1:t.requiredPlotType==="any"||t.requiredPlotType==="elder"&&m.plotType==="elder"||t.requiredPlotType==="normal"&&m.plotType==="normal"):[]}),J=m=>{L.value=m,u.value=!0},re=async m=>{if(m.owned<=0){y.warning("种子数量不足");return}try{await o.plant(L.value,m.id),y.success(`成功播种 ${m.name}`),u.value=!1}catch(t){y.error(t.message||"播种失败")}},K=async m=>{try{const t=await o.harvest(m);if(t.items&&t.items.length>0){const P=t.items.map(a=>`${a.itemName}x${a.quantity}`).join(", ");y.success(`采收成功！获得：${P}`)}else y.success("采收成功！")}catch(t){y.error(t.message||"采收失败")}},Y=async(m,t)=>{try{await o.handleEvent(m,t),y.success("处理成功！")}catch(P){y.error(P.message||"处理失败")}},de=async()=>{try{await o.expandGarden(),y.success("扩建成功！"),$.value=!1}catch(m){y.error(m.message||"扩建失败")}},ce=async()=>{try{await o.becomeElder(),y.success("恭喜晋升丹道长老！"),z.value=!1}catch(m){y.error(m.message||"晋升失败")}},ue=async m=>{if(o.remainingExploreToday<=0){y.warning("今日探索次数已用尽");return}await r(m)},r=async m=>{if(o.remainingExploreToday<=0){y.warning("今日探索次数已用尽");return}try{const t=await o.startExplore(m);C.value=t,N.value=!0}catch(t){y.error(t.message||"探索失败")}},k=()=>{N.value=!1,p.value="explore"},_=async m=>{try{const t=await o.combat(m);if(t.combatEnded)if(t.victory){let P="战斗胜利！";if(t.rewards&&(t.rewards.spiritStones&&(P+=` 获得 ${t.rewards.spiritStones} 灵石`),t.rewards.items&&t.rewards.items.length>0)){const a=t.rewards.items.map(I=>`${I.itemName}x${I.quantity}`).join(", ");P+=`, ${a}`}y.success(P)}else m==="flee"?y.info(t.success?"成功逃跑！":"逃跑失败！"):y.warning("战斗失败...")}catch(t){y.error(t.message||"行动失败")}};we(async()=>{try{await f.init(),q.value&&await Promise.all([o.fetchGarden(),o.fetchSeeds(),o.fetchExploreStatus()])}finally{h.value=!1}});let ee=null;return xe(()=>q.value,m=>{m?ee=setInterval(()=>{o.fetchGarden()},6e4):ee&&clearInterval(ee)},{immediate:!0}),(m,t)=>{const P=Ee("router-link");return i(),d("div",Pt,[h.value?(i(),d("div",Tt,[n(s(_e),{size:32,class:"spinning"}),t[11]||(t[11]=e("span",null,"正在加载药园...",-1))])):q.value?(i(),d(E,{key:2},[e("div",Nt,[(i(),d(E,null,S(12,a=>e("div",{key:a,class:"particle",style:A({"--delay":a*.5+"s","--x":Math.random()*100+"%"})},null,4)),64))]),e("div",Lt,[t[20]||(t[20]=e("div",{class:"header-glow"},null,-1)),e("div",_t,[e("div",At,[t[15]||(t[15]=e("div",{class:"icon-glow"},null,-1)),n(s(ye),{size:24,class:"garden-icon"})]),e("div",qt,[t[17]||(t[17]=e("h1",null,"黄枫谷药园",-1)),e("div",Gt,[e("span",Bt,[n(s(R),{size:12}),v(" "+c(X.value)+"/"+c(O.value)+" 灵田 ",1)]),s(o).isAlchemyElder?(i(),d("span",Vt,[n(s(te),{size:12}),t[16]||(t[16]=v(" 丹道长老 ",-1))])):w("",!0)])])]),e("div",Ut,[s(o).canExpand?(i(),d("button",{key:0,class:"expand-btn",onClick:t[0]||(t[0]=a=>$.value=!0)},[n(s(ke),{size:16}),t[18]||(t[18]=v(" 扩建 ",-1))])):w("",!0),T.value?(i(),d("button",{key:1,class:"elder-btn",onClick:t[1]||(t[1]=a=>z.value=!0)},[n(s(Ae),{size:16}),t[19]||(t[19]=v(" 晋升长老 ",-1))])):w("",!0)])]),n(s(Be),{value:p.value,"onUpdate:value":t[4]||(t[4]=a=>p.value=a),type:"segment",animated:"",class:"garden-tabs"},{default:g(()=>[n(s(se),{name:"plots"},{tab:g(()=>[e("div",jt,[n(s(Fe),{size:14}),t[21]||(t[21]=e("span",null,"灵田",-1))])]),default:g(()=>[e("div",Ft,[s(o).plotsWithEvents.length>0?(i(),d("div",Zt,[n(s(ne),{size:16}),e("span",null,c(s(o).plotsWithEvents.length)+" 块灵田需要处理事件",1)])):w("",!0),e("div",It,[e("h3",Dt,[n(s(R),{size:16}),t[22]||(t[22]=e("span",null,"凡俗灵田",-1)),e("span",Rt,"("+c(F.value)+"/"+c(G.value)+")",1)]),e("div",Wt,[(i(),d(E,null,S(8,a=>e("div",{key:"normal-"+(a-1),class:"plot-wrapper"},[n(he,{plot:B(a-1),index:a-1,isLocked:ie(a-1),onPlant:J,onHarvest:K,onHandleEvent:Y},null,8,["plot","index","isLocked"])])),64))])]),e("div",{class:U(["plot-section elder-section",{locked:!s(o).isAlchemyElder}])},[e("h3",Ot,[n(s(te),{size:16}),t[23]||(t[23]=e("span",null,"长老灵田",-1)),s(o).isAlchemyElder?w("",!0):(i(),d("span",Xt,"(需晋升丹道长老)"))]),e("div",Qt,[(i(),d(E,null,S(3,a=>e("div",{key:"elder-"+(a+7),class:"plot-wrapper"},[n(he,{plot:B(a+7),index:a+7,isLocked:!s(o).isAlchemyElder,isElderPlot:!0,onPlant:J,onHarvest:K,onHandleEvent:Y,onExplore:ue},null,8,["plot","index","isLocked"])])),64))])],2)])]),_:1}),n(s(se),{name:"seeds"},{tab:g(()=>[e("div",Jt,[n(s(ve),{size:14}),t[24]||(t[24]=e("span",null,"种子",-1))])]),default:g(()=>[e("div",Kt,[e("div",Yt,[(i(!0),d(E,null,S(s(o).seeds,a=>(i(),d("div",{key:a.id,class:U(["seed-card",{"no-stock":a.owned<=0}])},[e("div",es,[e("span",{class:"seed-name",style:A({color:s(fe)(a.quality)})},c(a.name),5),e("span",ts,"x"+c(a.owned),1)]),e("p",ss,c(a.description),1),e("div",as,[e("span",ns,[n(s(ae),{size:12}),v(" "+c(a.growthHours)+"小时 ",1)]),e("span",os,[n(s(pe),{size:12}),v(" "+c(a.yieldMin)+"-"+c(a.yieldMax),1)]),a.requiredPlotType==="elder"?(i(),d("span",ls,[n(s(te),{size:12}),t[25]||(t[25]=v(" 长老专属 ",-1))])):w("",!0)])],2))),128)),s(o).seeds.length===0?(i(),d("div",is,[n(s(ve),{size:32}),t[26]||(t[26]=e("span",null,"暂无可用种子",-1)),t[27]||(t[27]=e("p",null,"前往宗门宝库购买种子",-1))])):w("",!0)])])]),_:1}),Z.value?(i(),j(s(se),{key:0,name:"explore"},{tab:g(()=>[e("div",rs,[n(s(W),{size:14}),t[28]||(t[28]=e("span",null,"寻宝",-1))])]),default:g(()=>[e("div",ds,[e("div",cs,[e("div",us,[e("h3",null,[n(s(W),{size:20}),t[29]||(t[29]=v(" 洞天寻宝 ",-1))]),t[30]||(t[30]=e("p",null,"在长老灵田中探寻远古秘境，可能遭遇妖兽或发现宝藏",-1))]),e("div",ms,[e("span",null,"今日剩余："+c(s(o).remainingExploreToday)+"/3",1)])]),s(o).inCombat?(i(),d("div",ps,[n(Mt,{combat:s(o).exploreStatus?.combat,loading:s(o).actionLoading,onAttack:t[2]||(t[2]=a=>_("attack")),onFlee:t[3]||(t[3]=a=>_("flee"))},null,8,["combat","loading"])])):(i(),d("div",vs,[t[32]||(t[32]=e("h4",null,"选择灵田进行探索",-1)),e("div",ys,[(i(),d(E,null,S(3,a=>e("div",{key:"explore-"+(a+7),class:U(["explore-plot-item",{disabled:s(o).remainingExploreToday<=0}]),onClick:I=>r(a+7)},[e("div",hs,[n(s(Ie),{size:24})]),e("div",ks,[e("span",gs,c(a+8)+"号灵田",1),t[31]||(t[31]=e("span",{class:"explore-plot-hint"},"点击开始探索",-1))])],10,fs)),64))])]))])]),_:1})):w("",!0)]),_:1},8,["value"])],64)):(i(),d("div",Ht,[e("div",St,[n(s(ye),{size:64})]),t[13]||(t[13]=e("h2",null,"无法进入药园",-1)),t[14]||(t[14]=e("p",null,"只有黄枫谷弟子才能使用药园功能",-1)),n(P,{to:"/sect/my",class:"back-link"},{default:g(()=>[n(s(Ve),{size:16}),t[12]||(t[12]=v(" 返回宗门 ",-1))]),_:1})])),n(s(D),{show:u.value,"onUpdate:show":t[5]||(t[5]=a=>u.value=a),preset:"card",style:{width:"90%","max-width":"400px"}},{header:g(()=>[e("div",bs,[n(s(R),{size:18}),t[33]||(t[33]=e("span",null,"选择种子",-1))])]),default:g(()=>[e("div",ws,[e("p",xs,"选择要种植在第 "+c(L.value+1)+" 号灵田的种子：",1),e("div",Es,[(i(!0),d(E,null,S(Q.value,a=>(i(),d("div",{key:a.id,class:U(["seed-select-item",{disabled:a.owned<=0}]),onClick:I=>re(a)},[e("div",Cs,[e("span",{class:"seed-select-name",style:A({color:s(fe)(a.quality)})},c(a.name),5),e("span",zs,[n(s(ae),{size:12}),v(" "+c(a.growthHours)+"小时 ",1)])]),e("span",Ms,"x"+c(a.owned),1)],10,$s))),128)),Q.value.length===0?(i(),d("div",Ps,"没有可用的种子")):w("",!0)])])]),_:1},8,["show"]),n(s(D),{show:$.value,"onUpdate:show":t[7]||(t[7]=a=>$.value=a),preset:"dialog",type:"info"},{header:g(()=>[...t[34]||(t[34]=[e("span",null,"扩建药园",-1)])]),action:g(()=>[n(s(V),{onClick:t[6]||(t[6]=a=>$.value=!1)},{default:g(()=>[...t[37]||(t[37]=[v("取消",-1)])]),_:1}),n(s(V),{type:"primary",loading:s(o).actionLoading,onClick:de},{default:g(()=>[...t[38]||(t[38]=[v("确认扩建",-1)])]),_:1},8,["loading"])]),default:g(()=>[e("div",Ts,[e("p",null,[t[35]||(t[35]=v(" 消耗 ",-1)),e("strong",null,c(s(o).expansionCost),1),t[36]||(t[36]=v(" 宗门贡献扩建一块灵田？ ",-1))]),e("p",Hs,"当前灵田数量："+c(F.value)+"/"+c(G.value),1)])]),_:1},8,["show"]),n(s(D),{show:z.value,"onUpdate:show":t[9]||(t[9]=a=>z.value=a),preset:"dialog",type:"info"},{header:g(()=>[...t[39]||(t[39]=[e("span",null,"晋升丹道长老",-1)])]),action:g(()=>[n(s(V),{onClick:t[8]||(t[8]=a=>z.value=!1)},{default:g(()=>[...t[40]||(t[40]=[v("取消",-1)])]),_:1}),n(s(V),{type:"primary",loading:s(o).actionLoading,onClick:ce},{default:g(()=>[...t[41]||(t[41]=[v("确认晋升",-1)])]),_:1},8,["loading"])]),default:g(()=>[t[42]||(t[42]=e("div",{class:"elder-modal-content"},[e("div",{class:"elder-benefits"},[e("h4",null,"晋升后可获得："),e("ul",null,[e("li",null,"解锁3块长老专属灵田"),e("li",null,"可种植金叶仙草等稀有种子"),e("li",null,"解锁洞天寻宝功能")])]),e("div",{class:"elder-cost"},[e("p",null,[v(" 消耗 "),e("strong",null,"5000"),v(" 宗门贡献 ")]),e("p",{class:"requirement-hint"},"要求：筑基中期以上")])],-1))]),_:1},8,["show"]),n(s(D),{show:N.value,"onUpdate:show":t[10]||(t[10]=a=>N.value=a),preset:"card",style:{width:"90%","max-width":"400px"},closable:!s(o).inCombat},{header:g(()=>[e("div",Ss,[n(s(W),{size:18}),t[43]||(t[43]=e("span",null,"探索结果",-1))])]),default:g(()=>[e("div",Ns,[C.value?(i(),d("div",Ls,[e("p",_s,c(C.value.message),1),C.value.combat?.inCombat?(i(),d("div",As,[n(s(ne),{size:24,class:"monster-alert"}),e("p",null,[t[44]||(t[44]=v(" 遭遇 ",-1)),e("strong",null,c(C.value.combat.monster?.name),1),t[45]||(t[45]=v(" ！ ",-1))]),n(s(V),{type:"warning",onClick:k},{default:g(()=>[...t[46]||(t[46]=[v("进入战斗",-1)])]),_:1})])):C.value.rewards?(i(),d("div",qs,[t[47]||(t[47]=e("h4",null,"获得奖励：",-1)),e("div",Gs,[C.value.rewards.spiritStones?(i(),d("span",Bs,[n(s(qe),{size:14}),v(" "+c(C.value.rewards.spiritStones)+" 灵石 ",1)])):w("",!0),(i(!0),d(E,null,S(C.value.rewards.items,a=>(i(),d("span",{key:a.itemId,class:"reward-item"},[n(s(pe),{size:14}),v(" "+c(a.itemName)+" x"+c(a.quantity),1)]))),128))])])):w("",!0)])):w("",!0)])]),_:1},8,["show","closable"])])}}}),va=le(Vs,[["__scopeId","data-v-7d7d8a75"]]);export{va as default};
